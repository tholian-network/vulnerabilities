{
  "name": "CVE-2021-30159",
  "type": "access restriction bypass",
  "severity": "Medium",
  "vector": "Remote",
  "description": "An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x before 1.35.2. Users can bypass intended restrictions on deleting pages in certain \"fast double move\" situations. MovePage::isValidMoveTarget() uses FOR UPDATE, but it's only called if Title::getArticleID() returns non-zero with no special flags. Next, MovePage::moveToInternal() will delete the page if getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in the replica DB, isValidMove() will return true, and then moveToInternal() will unconditionally delete the page if it can be found in the master.",
  "groups": [
    "AVG-1775"
  ],
  "packages": [
    "mediawiki"
  ],
  "advisories": [],
  "references": [
    "https://phabricator.wikimedia.org/T272386",
    "https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/+/5c295d9c037c3a30ede5333ffbdf4413dd03097e%5E%21/"
  ],
  "notes": null
}