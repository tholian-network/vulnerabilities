{
  "name": "CVE-2021-31799",
  "type": "arbitrary command execution",
  "severity": "Medium",
  "vector": "Remote",
  "description": "RDoc before version 6.3.1, as bundled with Ruby before version 2.7.4 and 2.6.8 as well as GitLab before version 14.0.2, used to call Kernel#open to open a local file. If a Ruby project has a file whose name starts with \"|\" and ends with \"tags\", the command following the pipe character is executed. A malicious Ruby project could exploit it to run an arbitrary command execution against a user who attempts to run the rdoc command.",
  "groups": [
    "AVG-2140",
    "AVG-2125",
    "AVG-1906",
    "AVG-1905",
    "AVG-1901"
  ],
  "packages": [
    "gitlab-gitaly",
    "ruby2.6",
    "jruby",
    "gitlab",
    "ruby-rdoc"
  ],
  "advisories": [
    "ASA-202107-25",
    "ASA-202107-18"
  ],
  "references": [
    "https://www.ruby-lang.org/en/news/2021/05/02/os-command-injection-in-rdoc/",
    "https://github.com/ruby/rdoc/commit/a7f5d6ab88632b3b482fe10611382ff73d14eed7",
    "https://github.com/ruby/ruby/commit/483f303d02e768b69e476e0b9be4ab2f26389522",
    "https://github.com/ruby/ruby/commit/fe3c49c9baeeab58304ede915b7edd18ecf360fc"
  ],
  "notes": null
}