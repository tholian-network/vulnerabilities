{
  "name": "CVE-2021-34824",
  "type": "information disclosure",
  "severity": "Critical",
  "vector": "Remote",
  "description": "Istio before version 1.10.2 contains a remotely exploitable vulnerability where credentials specified in the Gateway and DestinationRule credentialName field can be accessed from different namespaces.\r\n\r\nThe Istio Gateway and DestinationRule can load private keys and certificates from Kubernetes secrets via the credentialName configuration. For Istio 1.8 and above, the secrets are conveyed from Istiod to gateways or workloads via the XDS API.\r\n\r\nIn the above approach, a gateway or workload deployment should only be able to access credentials (TLS certificates and private keys) stored in the Kubernetes secrets within its namespace. However, a bug in Istiod permits an authorized client the ability to access and retrieve any TLS certificate and private key cached in Istiod.",
  "groups": [
    "AVG-2113"
  ],
  "packages": [
    "istio"
  ],
  "advisories": [
    "ASA-202107-3"
  ],
  "references": [
    "https://istio.io/latest/news/security/istio-security-2021-007/",
    "https://github.com/istio/istio/commit/10674c9a86ece93dcd40efd8e4b9147bc8604460",
    "https://github.com/istio/istio/commit/f58f789f8e0d1580d00b68b76b1132163939b9ef"
  ],
  "notes": "Workaround\r\n==========\r\n\r\nThis vulnerability can be mitigated by disabling Istiod caching. Caching is disabled by setting an Istiod environment variable PILOT_ENABLE_XDS_CACHE=false. System and Istiod performance may be impacted as this disables XDS caching."
}