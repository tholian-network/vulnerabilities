{
  "name": "CVE-2022-2978",
  "type": "unknown",
  "severity": "Unknown",
  "vector": "Unknown",
  "description": "In alloc_inode, inode_init_always() could return -ENOMEM if security_inode_alloc() fails, which causes inode->i_private uninitialized. Then nilfs_is_metadata_file_inode() returns true and nilfs_free_inode() wrongly calls nilfs_mdt_destroy(), which frees the uninitialized inode->i_private and leads to crashes(e.g., UAF/GPF)",
  "groups": [
    "AVG-2837",
    "AVG-2836",
    "AVG-2835",
    "AVG-2834"
  ],
  "packages": [
    "linux-lts",
    "linux-zen",
    "linux-hardened",
    "linux"
  ],
  "advisories": [],
  "references": [
    "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=2e488f13755ffbb60f307e991b27024716a33b29",
    "https://lore.kernel.org/linux-fsdevel/20220816040859.659129-1-dzm91@hust.edu.cn/T/#u",
    "https://kernel.dance/#CVE-2022-2978"
  ],
  "notes": null
}