{
  "name": "CVE-2021-36740",
  "type": "url request injection",
  "severity": "Medium",
  "vector": "Remote",
  "description": "Varnish Cache before version 6.6.1, with HTTP/2 enabled, allows request smuggling and VCL authorization bypass via a large Content-Length header for a POST request.",
  "groups": [
    "AVG-2154"
  ],
  "packages": [
    "varnish"
  ],
  "advisories": [
    "ASA-202107-28"
  ],
  "references": [
    "https://varnish-cache.org/security/VSV00007.html",
    "https://github.com/varnishcache/varnish-cache/commit/7d73bc843ea9bff79e33773f1cfe2dffa7d03ea1"
  ],
  "notes": "Workaround\r\n==========\r\n\r\nThe issue can be mitigated by turning off support for HTTP/2, using\r\n\r\nsudo varnishadm param.set feature -http2\r\n\r\nor by preventing connection reuse with the following configuration:\r\n\r\nsub vcl_backend_fetch {\r\n      set bereq.http.Connection = \"close\";\r\n}"
}