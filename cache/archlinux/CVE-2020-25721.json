{
	"name": "CVE-2020-25721",
	"type": "privilege escalation",
	"severity": "Medium",
	"vector": "Remote",
	"description": "A security issue has been found in Samba versions 4.0.0 to 4.15.1. Samba as an AD DC did not provide a way for Linux applications to obtain a reliable SID (and samAccountName) in issued tickets.",
	"groups": [
		"AVG-2538"
	],
	"packages": [
		"samba"
	],
	"advisories": [],
	"references": [
		"https://www.samba.org/samba/security/CVE-2020-25721.html",
		"https://www.samba.org/samba/ftp/patches/security/samba-4.15.1-security-2021-11-09.patch"
	],
	"notes": "Workaround\r\n==========\r\n\r\nIt would be prudent to pre-create disabled users in Active Directory matching on all privileged names not held in Active Directory, eg\r\n\r\n samba-tool user add root -H ldap://$SERVER -U$USERNAME%$PASSWORD --random-password\r\n samba-tool user add ubuntu -H ldap://$SERVER -U$USERNAME%$PASSWORD --random-password\r\n ...\r\n (repeat for eg all system users under 1000 in /etc/passwd or special to any other AD-connected services, eg perhaps \"admin\" for a web-app)\r\n\r\nIf running a Microsoft Windows Active Directory, setting ms-DS-MachineAccountQuota to 0, in the Active Directory domain would be advised, if possible."
}