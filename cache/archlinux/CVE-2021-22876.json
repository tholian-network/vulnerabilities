{
  "name": "CVE-2021-22876",
  "type": "information disclosure",
  "severity": "Medium",
  "vector": "Remote",
  "description": "libcurl does not strip off user credentials from the URL when automatically populating the Referer: HTTP request header field in outgoing HTTP requests, and therefore risks leaking sensitive data to the server that is the target of the second HTTP request.\r\n\r\nlibcurl automatically sets the Referer: HTTP request header field in outgoing HTTP requests if the CURLOPT_AUTOREFERER option is set. With the curl tool, it is enabled with --referer \";auto\".\r\n\r\nThe issue has existed in libcurl since version 7.1.1 and is fixed in version 7.76.0.",
  "groups": [
    "AVG-1758",
    "AVG-1757",
    "AVG-1756",
    "AVG-1755",
    "AVG-1754",
    "AVG-1753"
  ],
  "packages": [
    "lib32-curl",
    "lib32-libcurl-gnutls",
    "libcurl-gnutls",
    "curl",
    "libcurl-compat",
    "lib32-libcurl-compat"
  ],
  "advisories": [],
  "references": [
    "https://curl.se/docs/CVE-2021-22876.html",
    "https://github.com/curl/curl/commit/7214288898f5625a6cc196e22a74232eada7861c"
  ],
  "notes": "Workaround\r\n==========\r\n\r\nThe issue can be mitigated by providing the credentials with -u or CURLOPT_USERPWD, or by avoiding ACURLOPT_AUTOREFERER and --referer \";auto\"."
}