<!doctype html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>ALAS2-2019-1162</title>
        <link rel='icon' type='image/x-icon' href='../static/favicon.ico' />
<link rel="stylesheet" href="../static/bootstrap.min.css" type='text/css' media='print, projection, screen' >
<link rel='stylesheet' href='../static/blue_style.css' type='text/css' media='print, projection, screen' />
<link rel='stylesheet' href='../static/fontawesome.css' type='text/css' media='print, projection, screen' />
<link rel='stylesheet' href='../static/style.css' type='text/css' media='print, projection, screen' />
<script type='text/javascript' src='../static/jquery.min.js'></script>
<script type='text/javascript' src='../static/jquery.tablesorter.min.js'></script>
<script type="text/javascript" src="../static/index.js"></script>

<!--Add constant cookie banner on this page-->
<script type = 'text/javascript'>
    var shortbread = AWSCShortbread();
    shortbread.checkForCookieConsent();
    function customize() {
        shortbread.customizeCookies();
    }
</script>

<style>
    a{text-decoration: none; color: #0073BB}
    a:visited{color: #0073BB}
    .Site {
        display: flex;
        display: -webkit-flex; /* Safari */
        min-height: 100vh;
        flex-direction: column;
    }
    .Site-content {
        flex: 1;
    }
</style>
    </head>
    <body class="Site">
        <main class="Site-content">
            <div class="container">
                <nav class="navbar navbar-fixed-top navbar-inverse" style="background-color: #000000" id="bs-navbar">
    <a style="font-size: 20px; color: #FF9900" class="navbar-brand" href="/"><b>Amazon Linux Security Center</b></a>
    <ul class="nav navbar-nav navbar-right" style="color: #ff9900">
    <li style="background-color: #333333;"> <a style="color: #FFFFFF" href="/">Amazon Linux</a> </li><li style="background-color: #FF9900;"> <a style="color: #000000" href="/alas2.html">Amazon Linux 2</a> </li><li style="background-color: #333333;"> <a style="color: #FFFFFF" href="/alas2022.html">Amazon Linux 2022</a> </li><li style="background-color: #333333;"> <a style="color: #FFFFFF" href="/announcements.html">Announcements</a> </li>
    </ul>
</nav>
            </div>
            <div style='min-height: 523px; margin-top:80px;' class='nine columns content-with-nav' role='main'>
                <section>
                    <div class='title'>
                        <h1 id='ALAS2-2019-1162'>ALAS2-2019-1162</h1>
                    </div>

                    <div class='text'>
                        <hr class='mid-pad'>
                        <span class='alas-info'>
                            
                            <b>Amazon Linux 2 Security Advisory:</b> ALAS-2019-1162
                            
                        </span><br />
                        <span class='alas-info'><b>Advisory Release Date:</b> 2019-02-16 00:34 Pacific</span><br />
                        <span class='alas-info'><b>Advisory Updated Date:</b> 2019-02-18 17:59 Pacific</span><br />

                        <div id='severity' class='alas-info'>
                            <b>Severity:</b>
                            <span class='date'>
                                <span class='bulletin-type'>
                                    <i class='fas fa-exclamation-triangle'></i>
                                </span>
                            </span>
                            Medium<br />
                        </div>

                        <div id='references'>
                            <b>References:</b>
                            <a href='/cve/html/CVE-2017-1000254.html' target='_blank'>CVE-2017-1000254&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2017-1000257.html' target='_blank'>CVE-2017-1000257&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2017-8816.html' target='_blank'>CVE-2017-8816&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2017-8817.html' target='_blank'>CVE-2017-8817&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2017-8818.html' target='_blank'>CVE-2017-8818&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2018-16839.html' target='_blank'>CVE-2018-16839&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2018-16840.html' target='_blank'>CVE-2018-16840&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2018-16842.html' target='_blank'>CVE-2018-16842&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2018-16890.html' target='_blank'>CVE-2018-16890&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2018-20483.html' target='_blank'>CVE-2018-20483&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2019-3822.html' target='_blank'>CVE-2019-3822&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <a href='/cve/html/CVE-2019-3823.html' target='_blank'>CVE-2019-3823&nbsp;<i class="fas fa-external-link-alt"></i></a>
                            <br />
                        </div>

                        <hr class='mid-pad'>
                        <div id='issue_overview'>
                            <b>Issue Overview:</b>
                            <p>libcurl  is vulnerable to a heap buffer out-of-bounds read. The function handling incoming NTLM type-2 messages (`lib/vauth/ntlm.c:ntlm_decode_type2_target`) does not validate incoming data correctly and is subject to an integer overflow vulnerability. Using that overflow, a malicious or broken NTLM server could trick libcurl to accept a bad length + offset combination that would lead to a buffer read out-of-bounds.(CVE-2018-16890) </p><p>The NTLM authentication feature in curl and libcurl before 7.57.0 on 32-bit platforms allows attackers to cause a denial of service (integer overflow and resultant buffer overflow, and application crash) or possibly have unspecified other impact via vectors involving long user and password fields.(CVE-2017-8816)</p><p>curl and libcurl before 7.57.0 on 32-bit platforms allow attackers to cause a denial of service (out-of-bounds access and application crash) or possibly have unspecified other impact because too little memory is allocated for interfacing to an SSL library.(CVE-2017-8818)</p><p>libcurl may read outside of a heap allocated buffer when doing FTP. When libcurl connects to an FTP server and successfully logs in (anonymous or not), it asks the server for the current directory with the `PWD` command. The server then responds with a 257 response containing the path, inside double quotes. The returned path name is then kept by libcurl for subsequent uses. Due to a flaw in the string parser for this directory name, a directory name passed like this but without a closing double quote would lead to libcurl not adding a trailing NUL byte to the buffer holding the name. When libcurl would then later access the string, it could read beyond the allocated heap buffer and crash or wrongly access data beyond the buffer, thinking it was part of the path. A malicious server could abuse this fact and effectively prevent libcurl-based clients to work with it - the PWD command is always issued on new FTP connections and the mistake has a high chance of causing a segfault. The simple fact that this has issue remained undiscovered for this long could suggest that malformed PWD responses are rare in benign servers. We are not aware of any exploit of this flaw. This bug was introduced in commit [415d2e7cb7](https://github.com/curl/curl/commit/415d2e7cb7), March 2005. In libcurl version 7.56.0, the parser always zero terminates the string but also rejects it if not terminated properly with a final double quote.(CVE-2017-1000254)</p><p>Curl versions 7.14.1 through 7.61.1 are vulnerable to a heap-based buffer over-read in the tool_msgs.c:voutf() function that may result in information exposure and denial of service.(CVE-2018-16842)</p><p>libcurl is vulnerable to a stack-based buffer overflow. The function creating an outgoing NTLM type-3 header (`lib/vauth/ntlm.c:Curl_auth_create_ntlm_type3_message()`), generates the request HTTP header contents based on previously received data. The check that exists to prevent the local buffer from getting overflowed is implemented wrongly (using unsigned math) and as such it does not prevent the overflow from happening. This output data can grow larger than the local buffer if very large &#39;nt response&#39; data is extracted from a previous NTLMv2 header provided by the malicious or broken HTTP server. Such a &#39;large value&#39; needs to be around 1000 bytes or more. The actual payload data copied to the target buffer comes from the NTLMv2 type-2 response header.(CVE-2019-3822)</p><p>libcurl is vulnerable to a heap out-of-bounds read in the code handling the end-of-response for SMTP. If the buffer passed to `smtp_endofresp()` isn&#39;t NUL terminated and contains no character ending the parsed number, and `len` is set to 5, then the `strtol()` call reads beyond the allocated buffer. The read contents will not be returned to the caller.(CVE-2019-3823)</p><p>The FTP wildcard function in curl and libcurl before 7.57.0 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) or possibly have unspecified other impact via a string that ends with an &#39;[&#39; character.(CVE-2017-8817)</p><p>set_file_metadata in xattr.c in GNU Wget before 1.20.1 stores a file&#39;s origin URL in the user.xdg.origin.url metadata attribute of the extended attributes of the downloaded file, which allows local users to obtain sensitive information (e.g., credentials contained in the URL) by reading this attribute, as demonstrated by getfattr. This also applies to Referer information in the user.xdg.referrer.url metadata attribute. According to 2016-07-22 in the Wget ChangeLog, user.xdg.origin.url was partially based on the behavior of fwrite_xattr in tool_xattr.c in curl.(CVE-2018-20483)</p><p>A buffer overrun flaw was found in the IMAP handler of libcurl. By tricking an unsuspecting user into connecting to a malicious IMAP server, an attacker could exploit this flaw to potentially cause information disclosure or crash the application.(CVE-2017-1000257)</p><p>A heap use-after-free flaw was found in curl versions from 7.59.0 through 7.61.1 in the code related to closing an easy handle. When closing and cleaning up an &#39;easy&#39; handle in the `Curl_close()` function, the library code first frees a struct (without nulling the pointer) and might then subsequently erroneously write to a struct field within that already freed struct.(CVE-2018-16840)</p><p>Curl versions 7.33.0 through 7.61.1 are vulnerable to a buffer overrun in the SASL authentication code that may lead to denial of service.(CVE-2018-16839)</p>
                        </div>

                        <div id='affected_packages' class='alas-info'>
                            <br />
                            <b>Affected Packages:</b>
                            <br />
                            <p>curl</p>
                        </div>

                        <div id='issue_correction'>
                            <br />
                            <b>Issue Correction:</b>
                            <br />Run <i>yum update curl</i> to update your system.
                                <br /></div>
                        <br />
                        <div id='new_packages'>
                            <b>New Packages:</b><pre>aarch64:<br />&nbsp;&nbsp;&nbsp; curl-7.61.1-9.amzn2.0.1.aarch64<br />&nbsp;&nbsp;&nbsp; libcurl-7.61.1-9.amzn2.0.1.aarch64<br />&nbsp;&nbsp;&nbsp; libcurl-devel-7.61.1-9.amzn2.0.1.aarch64<br />&nbsp;&nbsp;&nbsp; curl-debuginfo-7.61.1-9.amzn2.0.1.aarch64<br /><br />i686:<br />&nbsp;&nbsp;&nbsp; curl-7.61.1-9.amzn2.0.1.i686<br />&nbsp;&nbsp;&nbsp; libcurl-7.61.1-9.amzn2.0.1.i686<br />&nbsp;&nbsp;&nbsp; libcurl-devel-7.61.1-9.amzn2.0.1.i686<br />&nbsp;&nbsp;&nbsp; curl-debuginfo-7.61.1-9.amzn2.0.1.i686<br /><br />src:<br />&nbsp;&nbsp;&nbsp; curl-7.61.1-9.amzn2.0.1.src<br /><br />x86_64:<br />&nbsp;&nbsp;&nbsp; curl-7.61.1-9.amzn2.0.1.x86_64<br />&nbsp;&nbsp;&nbsp; libcurl-7.61.1-9.amzn2.0.1.x86_64<br />&nbsp;&nbsp;&nbsp; libcurl-devel-7.61.1-9.amzn2.0.1.x86_64<br />&nbsp;&nbsp;&nbsp; curl-debuginfo-7.61.1-9.amzn2.0.1.x86_64<br /><br /></pre></div>
                    </div>
                    <div style="flex:1; margin-bottom: 40px;" class="links-container">
                        <h3 class="section-heading">Additional References</h3>
                        <p>
                            Red Hat:&nbsp;<a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2017-1000254" target="_blank" rel="noopener noreferrer">CVE-2017-1000254</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2017-1000257" target="_blank" rel="noopener noreferrer">CVE-2017-1000257</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2017-8816" target="_blank" rel="noopener noreferrer">CVE-2017-8816</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2017-8817" target="_blank" rel="noopener noreferrer">CVE-2017-8817</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2017-8818" target="_blank" rel="noopener noreferrer">CVE-2017-8818</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2018-16839" target="_blank" rel="noopener noreferrer">CVE-2018-16839</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2018-16840" target="_blank" rel="noopener noreferrer">CVE-2018-16840</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2018-16842" target="_blank" rel="noopener noreferrer">CVE-2018-16842</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2018-16890" target="_blank" rel="noopener noreferrer">CVE-2018-16890</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2018-20483" target="_blank" rel="noopener noreferrer">CVE-2018-20483</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2019-3822" target="_blank" rel="noopener noreferrer">CVE-2019-3822</a>,
                            <a style="margin-bottom: 40px;" href="https://access.redhat.com/security/cve/CVE-2019-3823" target="_blank" rel="noopener noreferrer">CVE-2019-3823</a></p>
                        <p>
                            Mitre:&nbsp;<a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000254" target="_blank" rel="noopener noreferrer">CVE-2017-1000254</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000257" target="_blank" rel="noopener noreferrer">CVE-2017-1000257</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8816" target="_blank" rel="noopener noreferrer">CVE-2017-8816</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8817" target="_blank" rel="noopener noreferrer">CVE-2017-8817</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8818" target="_blank" rel="noopener noreferrer">CVE-2017-8818</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16839" target="_blank" rel="noopener noreferrer">CVE-2018-16839</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16840" target="_blank" rel="noopener noreferrer">CVE-2018-16840</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16842" target="_blank" rel="noopener noreferrer">CVE-2018-16842</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16890" target="_blank" rel="noopener noreferrer">CVE-2018-16890</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20483" target="_blank" rel="noopener noreferrer">CVE-2018-20483</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3822" target="_blank" rel="noopener noreferrer">CVE-2019-3822</a>,
                            <a style="margin-bottom: 40px;" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3823" target="_blank" rel="noopener noreferrer">CVE-2019-3823</a></p>
                    </div>
                </section>
            </div>
        </main>
        <footer style="padding-left: 30px; padding-right: 30px;"><p style="color: #687078">
      CVE description copyright &#169 2021
      <a href="https://cve.mitre.org/about/termsofuse.html" target="_blank" rel="noopener noreferrer">The MITRE Corporation</a>
    </p>
    <p style="color: #687078">
      CVE description copyright &#169 2021 Red Hat, Inc. Per
      <a href="https://access.redhat.com/security/data" target="_blank" rel="noopener noreferrer">https://access.redhat.com/security/data</a>,
      RedHat's CVE report is licensed under
      <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer">CC BY 4.0</a>.
    </p>
</footer>
        <footer style="padding-left: 30px; padding-right: 30px;"><p>
        <a href="https://aws.amazon.com/privacy/" target="_blank" rel="noopener noreferrer">Privacy</a> |
        <a href="https://aws.amazon.com/terms/" target="_blank" rel="noopener noreferrer">Site terms</a> |
        <a href="#" onclick="customize()">Cookie preferences</a> |
        <span style="color: #687078">&#169 2021, Amazon Web Services, Inc. or its affiliates. All rights reserved.</span>
    </p>
</footer>
    </body>
</html>