{
	"id": "CVE-2019-14833",
	"description": "A flaw was found in Samba, all versions starting samba 4.5.0 before samba 4.9.15, samba 4.10.10, samba 4.11.2, in the way it handles a user password change or a new password for a samba user. The Samba Active Directory Domain Controller can be configured to use a custom script to check for password complexity. This configuration can fail to verify password complexity when non-ASCII characters are used in the password, which could lead to weak passwords being set for samba users, making it vulnerable to dictionary attacks.\n\nA security issue has been found in Samba before 4.10.10, where the check password script does not receive the full password string when the password contains multi-byte (non-ASCII) characters.\r\nSince Samba Version 4.5.0 a Samba AD DC can use a custom command to verify the password complexity. The command can be specified with the \"check password script\" smb.conf parameter. This command is called when Samba handles a user password change or a new user password is set. The script receives the new cleartext password string in order to run custom password complexity checks like dictionary checks to avoid weak user passwords. If the check password script parameter is not specified, Samba runs the internal password quality checks. The internal check makes sure that a password contains characters from three of five different characters categories.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "samba",
			"version": "< 4.10.10-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "samba",
			"version": "< 2:4.11.1+dfsg-2"
		},
		{
			"vendor": "debian-bullseye",
			"product": "samba",
			"version": "< 2:4.11.1+dfsg-2"
		},
		{
			"vendor": "debian-stretch",
			"product": "samba",
			"version": "< 2:4.5.16+dfsg-1+deb9u4"
		}
	],
	"references": [
		"https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-14833",
		"https://www.samba.org/samba/security/CVE-2019-14833.html",
		"https://www.synology.com/security/advisory/Synology_SA_19_35",
		"http://lists.opensuse.org/opensuse-security-announce/2019-11/msg00015.html",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UMIYCYXCPRTVCVZ3TP6ZGPJ6RZS3IX4G/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OKPYHDFI7HRELVXBE5J4MTGSI35AKFBI/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XQ3IUACPZJXSC4OM6P2V4IC4QMZQZWPD/",
		"https://lists.debian.org/debian-lts-announce/2021/05/msg00023.html",
		"https://download.samba.org/pub/samba/patches/security/samba-4.10.9-security-2019-10-29.patch"
	],
	"_edited_": false,
	"severity": "Medium"
}