{
	"id": "CVE-2017-15115",
	"description": "The sctp_do_peeloff function in net/sctp/socket.c in the Linux kernel before 4.14 does not check whether the intended netns is used in a peel-off action, which allows local users to cause a denial of service (use-after-free and system crash) or possibly have unspecified other impact via crafted system calls.\n\nAffected: n/a Linux kernel before 4.14-rc6 Linux kernel before 4.14-rc6\n\nIt was found that in Linux kernel before 4.14 when peeling off an association to the socket in another network namespace, all transports in this association are not to be rehashed and keep use the old key in hashtable. A kernel would miss removing transports from hashtable when closing the socket and all transports are being freed. Later on a use-after-free issue could be caused when looking up an association and dereferencing the transports.",
	"hardware": [],
	"software": [
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.65-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.65-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.14-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.13.13-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.13.13-1"
		}
	],
	"references": [
		"https://github.com/google/syzkaller/blob/master/docs/linux/found_bugs_usb.md",
		"https://git.kernel.org/linus/df80cd9b28b9ebaa284a41df611dbf3a2d05ca74",
		"https://bugzilla.redhat.com/show_bug.cgi?id=1513345",
		"http://seclists.org/oss-sec/2017/q4/282",
		"https://github.com/torvalds/linux/commit/df80cd9b28b9ebaa284a41df611dbf3a2d05ca74",
		"https://lists.debian.org/debian-lts-announce/2017/12/msg00004.html",
		"https://usn.ubuntu.com/3583-2/",
		"http://lists.opensuse.org/opensuse-security-announce/2018-01/msg00007.html",
		"https://patchwork.ozlabs.org/patch/827077/",
		"https://usn.ubuntu.com/3582-1/",
		"https://source.android.com/security/bulletin/pixel/2018-04-01",
		"https://usn.ubuntu.com/3583-1/",
		"http://www.securityfocus.com/bid/101877",
		"https://usn.ubuntu.com/3581-1/",
		"https://usn.ubuntu.com/3581-3/",
		"https://usn.ubuntu.com/3581-2/",
		"http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=df80cd9b28b9ebaa284a41df611dbf3a2d05ca74",
		"https://usn.ubuntu.com/3582-2/"
	],
	"severity": "high",
	"state": "invalid",
	"_is_edited": false
}