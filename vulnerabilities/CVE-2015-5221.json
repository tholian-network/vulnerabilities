{
	"id": "CVE-2015-5221",
	"description": "Use-after-free vulnerability in the mif_process_cmpt function in libjasper/mif/mif_cod.c in the JasPer JPEG-2000 library before 1.900.2 allows remote attackers to cause a denial of service (crash) via a crafted JPEG 2000 image file.\n\nA use-after-free and double free has been discovered in the function mif_process_cmpt of the src/libjasper/mif/mif_cod.c file. Both tvp and tvp->buf are freed by  as_tvparser_destroy(tvp) (line 572), but if one of the two following branch conditions is taken (line 573/576), a second call to jas_tvparser_destroy(tvp) occurs (line 586). It is a use-after-free because before calling free in jas_tvparser_destroy there is a check to tvp->buf, while tvp could have been freed. Two double free take place just after this check (on tvp->buf and tvp).",
	"hardware": [],
	"software": [
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		},
		{
			"name": "jasper",
			"platform": "archlinux",
			"version": "< 1.900.5-1"
		}
	],
	"references": [
		"https://github.com/mdadams/jasper/issues/19#issuecomment-251642985",
		"http://seclists.org/oss-sec/2015/q3/408",
		"https://lists.debian.org/debian-lts-announce/2018/11/msg00023.html",
		"http://www.openwall.com/lists/oss-security/2015/08/20/4",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AXWV22WGSQFDRPE7G6ECGP3QXS2V2A2M/",
		"https://access.redhat.com/errata/RHSA-2017:1208",
		"http://lists.opensuse.org/opensuse-updates/2016-11/msg00018.html",
		"https://github.com/mdadams/jasper/commit/df5d2867e8004e51e18b89865bc4aa69229227b3",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UNLVBZWDEXZCFWOBZ3YVEQINMRBRX5QV/",
		"http://lists.opensuse.org/opensuse-updates/2016-11/msg00010.html",
		"https://bugzilla.redhat.com/show_bug.cgi?id=1255710",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3QIZNTZDXOJR5BTRZKCS3GVHVZV2PWHH/",
		"https://usn.ubuntu.com/3693-1/",
		"http://lists.opensuse.org/opensuse-updates/2016-11/msg00064.html",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AXWV22WGSQFDRPE7G6ECGP3QXS2V2A2M/",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UNLVBZWDEXZCFWOBZ3YVEQINMRBRX5QV/",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3QIZNTZDXOJR5BTRZKCS3GVHVZV2PWHH/"
	],
	"severity": "high",
	"state": "published",
	"_is_edited": false
}