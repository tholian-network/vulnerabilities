{
	"id": "CVE-2021-35477",
	"description": "In the Linux kernel through 5.13.7, an unprivileged BPF program can obtain sensitive information from kernel memory via a Speculative Store Bypass side-channel attack because a certain preempting store operation does not necessarily occur before a store operation that has an attacker-controlled value.\n\nAn issue has been discovered in the Linux kernel mechanism to mitigate Speculative Store Bypass in BPF. On affected systems, an unprivileged BPF program can exploit any of these issues to disclose the content of arbitrary kernel memory via a side-channel.\r\n\r\nWhen protecting memory operations against Speculative Store Bypass, the technique used by the BPF verifier to manage speculation is unreliable. Specifically, each potentially problematic memory store operations is sanitized by inserting a preempting store of zero value. The preempting store is incorrectly assumed to complete \"fast\" as it only depends on the BPF stack frame pointer. However a few different scenarios have been identified where this assumption is invalid, by demonstrating a dependent load instruction to speculatively execute ahead of the preempting store. Practical attacks have been shown to disclose content of arbitrary kernel memory via a side-channel.",
	"hardware": [],
	"software": [
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.56-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.8.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.8.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.46-4"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-4"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.208-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "linux-4.19",
			"platform": "debian-9",
			"version": "< 4.19.208-1~deb9u1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.56-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.8.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.8.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.46-4"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-4"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.208-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "linux-4.19",
			"platform": "debian-9",
			"version": "< 4.19.208-1~deb9u1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.56-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.8.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.8.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.56-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.8.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.8.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.56-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.8.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.8.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.56-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.8.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.8.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		}
	],
	"references": [
		"https://www.openwall.com/lists/oss-security/2021/08/01/3",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.13.8&id=ddab060f996e17b38bb181c5fd11a83fd1bfa0df",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.13.8&id=0b27bdf02c400684225ee5ee99970bcbf5082282",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.56&id=bea9e2fd180892eba2574711b05b794f1d0e7b73",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.56&id=0e9280654aa482088ee6ef3deadef331f5ac5fb0",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=f5e81d1117501546b7be050c5fbafa6efd2c722c",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=2039f26f3aca5b0e419b98f65dd36481337b86ee",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6JKK6XNRZX5BT5QVYOKGVJ2BHFZAP5EX/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/565ZS55ZFEN62WVRRORT7R63RXW5F4T4/",
		"https://lists.debian.org/debian-lts-announce/2021/10/msg00010.html"
	],
	"severity": "medium",
	"state": "published",
	"_is_edited": false
}