{
	"id": "CVE-2018-7184",
	"description": "ntpd in ntp 4.2.8p4 before 4.2.8p11 drops bad packets before updating the \"received\" timestamp, which allows remote attackers to cause a denial of service (disruption) by sending a packet with a zero-origin timestamp causing the association to reset and setting the contents of the packet as the most recent timestamp. This issue is a result of an incomplete fix for CVE-2015-7704.\n\nThe fix for NtpBug2952 was incomplete, and while it fixed one problem it created another. Specifically, it drops bad packets before updating the \"received\" timestamp. This means a third-party can inject a packet with a zero-origin timestamp, meaning the sender wants to reset the association, and the transmit timestamp in this bogus packet will be saved as the most recent \"received\" timestamp. The real remote peer does not know this value and this will disrupt the association until the association resets.",
	"hardware": [],
	"software": [
		{
			"name": "ntp",
			"platform": "archlinux",
			"version": "< 4.2.8.p11-1"
		},
		{
			"name": "ntp",
			"platform": "debian-11",
			"version": "< 1:4.2.8p11+dfsg-1"
		},
		{
			"name": "ntp",
			"platform": "debian-10",
			"version": "< 1:4.2.8p11+dfsg-1"
		},
		{
			"name": "ntp",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "ntpsec",
			"platform": "debian-12",
			"version": "< 0"
		},
		{
			"name": "ntpsec",
			"platform": "debian-11",
			"version": "< 0"
		},
		{
			"name": "ntpsec",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "ntp",
			"platform": "archlinux",
			"version": "< 4.2.8.p11-1"
		},
		{
			"name": "ntp",
			"platform": "debian-11",
			"version": "< 1:4.2.8p11+dfsg-1"
		},
		{
			"name": "ntp",
			"platform": "debian-10",
			"version": "< 1:4.2.8p11+dfsg-1"
		},
		{
			"name": "ntp",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "ntpsec",
			"platform": "debian-12",
			"version": "< 0"
		},
		{
			"name": "ntpsec",
			"platform": "debian-11",
			"version": "< 0"
		},
		{
			"name": "ntpsec",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "ntp",
			"platform": "archlinux",
			"version": "< 4.2.8.p11-1"
		},
		{
			"name": "ntp",
			"platform": "archlinux",
			"version": "< 4.2.8.p11-1"
		},
		{
			"name": "ntp",
			"platform": "archlinux",
			"version": "< 4.2.8.p11-1"
		},
		{
			"name": "ntp",
			"platform": "archlinux",
			"version": "< 4.2.8.p11-1"
		}
	],
	"references": [
		"http://support.ntp.org/bin/view/Main/NtpBug3453",
		"http://packetstormsecurity.com/files/146631/Slackware-Security-Advisory-ntp-Updates.html",
		"http://www.securityfocus.com/bid/103192",
		"https://security.gentoo.org/glsa/201805-12",
		"https://security.FreeBSD.org/advisories/FreeBSD-SA-18:02.ntp.asc",
		"https://security.netapp.com/advisory/ntap-20180626-0001/",
		"http://www.securityfocus.com/archive/1/541824/100/0/threaded",
		"https://usn.ubuntu.com/3707-1/",
		"https://www.synology.com/support/security/Synology_SA_18_13",
		"https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbux03962en_us"
	],
	"severity": "medium",
	"state": "published",
	"_is_edited": false
}