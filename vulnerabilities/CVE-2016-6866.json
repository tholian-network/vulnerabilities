{
	"id": "CVE-2016-6866",
	"description": "slock allows attackers to bypass the screen lock via vectors involving an invalid password hash, which triggers a NULL pointer dereference and crash.\n\nA null pointer dereference vulnerability has been discovered in the screen locking application slock. It calls crypt(3) and uses the return value for strcmp(3) without checking to see if the return value of crypt(3) was a NULL pointer. If the hash returned by (getspnam()->sp_pwdp) is invalid, crypt(3) will return NULL and set errno to EINVAL. This will cause slock to segfault which then leaves the machine unprotected. A couple of common scenarios where this\nmight happen are:\n\n- a machine using NSS for authentication; on the machine this bug was discovered, (getspnam()->sp_pwdp) returns \"*\".\n- the user's account has been disabled for one reason or another; maybe account expiry or password expiry.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "slock",
			"version": "< 1.4-2"
		},
		{
			"vendor": "debian-bookworm",
			"product": "suckless-tools",
			"version": "< 41-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "suckless-tools",
			"version": "< 41-1"
		},
		{
			"vendor": "debian-buster",
			"product": "suckless-tools",
			"version": "< 41-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "suckless-tools",
			"version": "< 41-1"
		}
	],
	"references": [
		"http://www.openwall.com/lists/oss-security/2016/08/18/24",
		"http://s1m0n.dft-labs.eu/files/slock/slock.txt",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RZPEJQNVODYSI4WQXM5GQKXRO7TPK2VG/",
		"http://www.openwall.com/lists/oss-security/2016/08/18/22",
		"http://git.suckless.org/slock/commit/?id=d8bec0f6fdc8a246d78cb488a0068954b46fcb29",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2FYPV6QQPPYBL3Z2BYNYEJB67FSC55OR/",
		"http://www.securityfocus.com/bid/92546",
		"http://seclists.org/oss-sec/2016/q3/333"
	],
	"_edited_": false,
	"severity": "Medium"
}