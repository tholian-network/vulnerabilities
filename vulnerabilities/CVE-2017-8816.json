{
	"id": "CVE-2017-8816",
	"description": "The NTLM authentication feature in curl and libcurl before 7.57.0 on 32-bit platforms allows attackers to cause a denial of service (integer overflow and resultant buffer overflow, and application crash) or possibly have unspecified other impact via vectors involving long user and password fields.\n\nA buffer overrun flaw has been found in libcurl > 7.15.4 and < 7.57.0, in the NTLM authentication code. The internal function `Curl_ntlm_core_mk_ntlmv2_hash` sums up the lengths of the user name + password (= SUM) and multiplies the sum by two (= SIZE) to figure out how large storage to allocate from the heap. The SUM value is subsequently used to iterate over the input and generate output into the storage buffer. On systems with a 32 bit `size_t`, the math to calculate SIZE triggers an integer overflow when the combined lengths of the user name and password is larger than 2GB (2^31 bytes). This integer overflow usually causes a very small buffer to actually get allocated instead of the intended very huge one, making the use of that buffer end up in a buffer overrun. \r\nThis is only an issue on 32 bit systems. It also requires the user and password fields to use more than 2GB of memory combined, which in itself should be rare.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "lib32-curl",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "archlinux",
			"product": "lib32-libcurl-compat",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "archlinux",
			"product": "lib32-libcurl-gnutls",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "archlinux",
			"product": "curl",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "archlinux",
			"product": "libcurl-compat",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "archlinux",
			"product": "libcurl-gnutls",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "curl",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "curl",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "debian-buster",
			"product": "curl",
			"version": "< 7.57.0-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "curl",
			"version": "< 7.52.1-5+deb9u3"
		}
	],
	"references": [
		"http://security.cucumberlinux.com/security/details.php?id=161",
		"https://security.gentoo.org/glsa/201712-04",
		"https://access.redhat.com/errata/RHSA-2018:3558",
		"https://curl.haxx.se/docs/adv_2017-12e7.html",
		"http://www.securityfocus.com/bid/101998",
		"http://www.securitytracker.com/id/1039896",
		"https://www.debian.org/security/2017/dsa-4051",
		"http://www.securitytracker.com/id/1040608",
		"https://curl.haxx.se/docs/adv_2017-11e7.html",
		"https://curl.haxx.se/CVE-2017-8816.patch",
		"https://github.com/curl/curl/commit/7f2a1df6f5fc598750b2c6f34465c8d924db28cc"
	],
	"_edited_": false,
	"severity": "High"
}