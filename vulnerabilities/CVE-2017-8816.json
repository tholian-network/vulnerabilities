{
	"id": "CVE-2017-8816",
	"description": "A buffer overrun flaw has been found in libcurl > 7.15.4 and < 7.57.0, in the NTLM authentication code. The internal function `Curl_ntlm_core_mk_ntlmv2_hash` sums up the lengths of the user name + password (= SUM) and multiplies the sum by two (= SIZE) to figure out how large storage to allocate from the heap. The SUM value is subsequently used to iterate over the input and generate output into the storage buffer. On systems with a 32 bit `size_t`, the math to calculate SIZE triggers an integer overflow when the combined lengths of the user name and password is larger than 2GB (2^31 bytes). This integer overflow usually causes a very small buffer to actually get allocated instead of the intended very huge one, making the use of that buffer end up in a buffer overrun. \r\nThis is only an issue on 32 bit systems. It also requires the user and password fields to use more than 2GB of memory combined, which in itself should be rare.",
	"hardware": [],
	"software": [
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.57.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.57.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.57.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.57.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.57.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.57.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.38.0-4+deb8u8"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.52.1-5+deb9u3"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.57.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "< 7.57.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "< 7.57.0-1"
		}
	],
	"references": [
		"https://curl.haxx.se/docs/adv_2017-11e7.html",
		"https://curl.haxx.se/docs/adv_2017-af0a.html",
		"https://curl.haxx.se/docs/adv_2017-ae72.html",
		"https://curl.haxx.se/CVE-2017-8816.patch",
		"https://github.com/curl/curl/commit/7f2a1df6f5fc598750b2c6f34465c8d924db28cc",
		"https://security-tracker.debian.org/tracker/DSA-4051-1"
	],
	"severity": "high",
	"state": "invalid",
	"is_edited": false
}