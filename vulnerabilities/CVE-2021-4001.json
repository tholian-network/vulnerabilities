{
	"id": "CVE-2021-4001",
	"description": "A race condition was found in the Linux kernel's ebpf verifier between bpf_map_update_elem and bpf_map_freeze due to a missing lock in kernel/bpf/syscall.c. In this flaw, a local user with a special privilege (cap_sys_admin or cap_bpf) can modify the frozen mapped address space. This flaw affects kernel versions prior to 5.16 rc2.\n\nWhen a map is read-only for the ebpf program and is frozen, the ebpf verifier will directly take the value from the map and directly use the value to participate in the verification of the ebpf verifier. After the ebpf program passes the verification of the verifier, and then uses the race condition bug to modify the frozen map content, all the assumptions of the ebpf verifier will be invalid, and it may also lead to the problem of local privilege escalation.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "linux-hardened",
			"version": "< 5.15.5.hardened1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux",
			"version": "< 5.15.5.arch1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-zen",
			"version": "< 5.15.5.zen1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-lts",
			"version": "< 5.10.83-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "linux",
			"version": "< 5.15.5-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "linux",
			"version": "< 5.10.84-1"
		},
		{
			"vendor": "debian-buster",
			"product": "linux",
			"version": "< 0"
		},
		{
			"vendor": "debian-stretch",
			"product": "linux",
			"version": "< 0"
		}
	],
	"references": [
		"https://bugzilla.redhat.com/show_bug.cgi?id=2025645",
		"https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=353050be4c19e102178ccc05988101887c25ae53",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.15.5&id=a5d1d3522232b4af1f5dee02d381e6fa86be8e2d",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.83&id=33fe044f6a9e8977686a6a09f0bf33e5cc75257e"
	],
	"_edited_": false,
	"severity": "Medium"
}