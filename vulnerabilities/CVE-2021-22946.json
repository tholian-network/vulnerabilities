{
	"id": "CVE-2021-22946",
	"description": "A user can tell curl >= 7.20.0 and <= 7.78.0 to require a successful upgrade to TLS when speaking to an IMAP, POP3 or FTP server (`--ssl-reqd` on the command line or`CURLOPT_USE_SSL` set to `CURLUSESSL_CONTROL` or `CURLUSESSL_ALL` withlibcurl). This requirement could be bypassed if the server would return a properly crafted but perfectly legitimate response.This flaw would then make curl silently continue its operations **withoutTLS** contrary to the instructions and expectations, exposing possibly sensitive data in clear text over the network.\n\nAffected: n/a https://github.com/curl/curl curl 7.20.0 to and including 7.78.0\n\nA security issue was found in curl before 7.79.0. A user can tell curl to require a successful upgrade to TLS when speaking to an IMAP, POP3 or FTP server (--ssl-reqd on the command line or CURLOPT_USE_SSL set to CURLUSESSL_CONTROL or CURLUSESSL_ALL with libcurl). This requirement could be bypassed if the server would return a properly crafted but perfectly legitimate response.\r\nThis flaw would then make curl silently continue its operations without TLS contrary to the instructions and expectations, exposing possibly sensitive data in clear text over the network.",
	"hardware": [],
	"software": [
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.79.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u16"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.79.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u16"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.79.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.79.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.79.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "*"
		}
	],
	"references": [
		"https://curl.se/docs/CVE-2021-22946.html",
		"https://github.com/curl/curl/commit/364f174724ef115",
		"https://hackerone.com/reports/1334111",
		"https://lists.debian.org/debian-lts-announce/2021/09/msg00022.html",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RWLEC6YVEM2HWUBX67SDGPSY4CQB72OE/",
		"https://www.oracle.com/security-alerts/cpuoct2021.html",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/APOAK4X73EJTAPTSVT7IRVDMUWVXNWGD/",
		"https://www.oracle.com/security-alerts/cpujan2022.html",
		"https://security.netapp.com/advisory/ntap-20211029-0003/",
		"https://security.netapp.com/advisory/ntap-20220121-0008/",
		"https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf",
		"https://support.apple.com/kb/HT213183",
		"http://seclists.org/fulldisclosure/2022/Mar/29",
		"https://www.oracle.com/security-alerts/cpuapr2022.html"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}