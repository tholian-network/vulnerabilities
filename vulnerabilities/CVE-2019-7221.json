{
	"id": "CVE-2019-7221",
	"description": "The KVM implementation in the Linux kernel through 4.20.5 has a Use-after-Free.\n\nA use-after-free vulnerability was found in the way the Linux kernel's KVM hypervisor emulates a preemption timer for L2 guests when nested (=1) virtualization is enabled. This high resolution timer(hrtimer) runs when a L2 guest is active. After VM exit, the sync_vmcs12() timer object is stopped. The use-after-free occurs if the timer object is freed before calling sync_vmcs12() routine. A guest user/process could use this flaw to crash the host kernel resulting in a denial of service or, potentially, gain privileged access to a system.",
	"hardware": [],
	"software": [
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.161-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.161-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		}
	],
	"references": [
		"https://bugs.chromium.org/p/project-zero/issues/detail?id=1759&desc=2",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=353c0956a618a07ba4bbe7ad00ff29fe70e8412a",
		"http://packetstormsecurity.com/files/151713/KVM-VMX-Preemption-Timer-Use-After-Free.html",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KDOXCX3QFVWYXH5CQMGDDE7H6MUG5XGG/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/Y2HMABEMJDPA6LPCBE5WIEZXUKY7DLTN/",
		"https://github.com/torvalds/linux/commits/master/arch/x86/kvm",
		"http://lists.opensuse.org/opensuse-security-announce/2019-02/msg00042.html",
		"http://www.openwall.com/lists/oss-security/2019/02/18/2",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ecec76885bcfe3294685dc363fd1273df0d5d65f",
		"https://bugs.chromium.org/p/project-zero/issues/detail?id=1760",
		"https://lists.debian.org/debian-lts-announce/2019/03/msg00034.html",
		"https://lists.debian.org/debian-lts-announce/2019/04/msg00004.html",
		"https://usn.ubuntu.com/3932-1/",
		"https://usn.ubuntu.com/3932-2/",
		"https://usn.ubuntu.com/3930-1/",
		"https://usn.ubuntu.com/3931-1/",
		"https://usn.ubuntu.com/3931-2/",
		"https://usn.ubuntu.com/3930-2/",
		"https://security.netapp.com/advisory/ntap-20190404-0002/",
		"https://access.redhat.com/errata/RHSA-2019:0833",
		"https://access.redhat.com/errata/RHSA-2019:0818",
		"https://lists.debian.org/debian-lts-announce/2019/05/msg00002.html",
		"https://access.redhat.com/errata/RHBA-2019:0959",
		"https://support.f5.com/csp/article/K08413011",
		"https://access.redhat.com/errata/RHSA-2019:3967",
		"https://access.redhat.com/errata/RHSA-2019:4058"
	],
	"severity": "critical",
	"state": "published",
	"_is_edited": false
}