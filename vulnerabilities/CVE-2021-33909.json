{
	"id": "CVE-2021-33909",
	"description": "fs/seq_file.c in the Linux kernel 3.16 through 5.13.x before 5.13.4 does not properly restrict seq buffer allocations, leading to an integer overflow, an Out-of-bounds Write, and escalation to root by an unprivileged user, aka CID-8cae8cd89f05.\n\nAn privilege escalation security issue has been found in the filesystem layer of the Linux kernel before version 5.13.4. An unprivileged local attacker can obtain full root privileges by creating, mounting, and deleting a deep directory structure whose total path length exceeds 1GB, which leads to an uncontrolled out-of-bounds write.",
	"hardware": [],
	"software": [
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.52-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.12.19.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.4.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.46-2"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-2"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.272-2"
		},
		{
			"name": "linux-4.19",
			"platform": "debian-9",
			"version": "< 4.19.194-3~deb9u1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.52-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.12.19.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.4.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.46-2"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-2"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.194-3"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.272-2"
		},
		{
			"name": "linux-4.19",
			"platform": "debian-9",
			"version": "< 4.19.194-3~deb9u1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.52-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.12.19.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.4.arch1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.52-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.12.19.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.4.arch1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.52-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.12.19.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.4.arch1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.52-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.12.19.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.4.arch1-1"
		}
	],
	"references": [
		"https://www.qualys.com/2021/07/20/cve-2021-33909/sequoia-local-privilege-escalation-linux.txt",
		"https://www.qualys.com/2021/07/20/cve-2021-33909/cve-2021-33909-crasher.c",
		"https://www.qualys.com/2021/07/20/cve-2021-33909/cve-2021-33909-exploit.tar.gz",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.13.4&id=71de462034c69525a5049fbdf3903c5833cbce04",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.12.19&id=514b6531b1cbb64199db63bfdb80953d71998cca",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.52&id=174c34d9cda1b5818419b8f5a332ced10755e52f",
		"https://security-tracker.debian.org/tracker/DSA-4941-1",
		"https://lists.debian.org/debian-lts-announce/2021/07/msg00016.html",
		"https://lists.debian.org/debian-lts-announce/2021/07/msg00014.html",
		"https://lists.debian.org/debian-lts-announce/2021/07/msg00015.html",
		"https://www.debian.org/security/2021/dsa-4941",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/Z4UHHIGISO3FVRF4CQNJS4IKA25ATSFU/",
		"http://www.openwall.com/lists/oss-security/2021/07/22/7",
		"http://www.openwall.com/lists/oss-security/2021/08/25/10",
		"http://www.openwall.com/lists/oss-security/2021/09/17/2",
		"http://www.openwall.com/lists/oss-security/2021/09/17/4",
		"http://www.openwall.com/lists/oss-security/2021/09/21/1",
		"https://www.oracle.com/security-alerts/cpujan2022.html",
		"https://www.openwall.com/lists/oss-security/2021/07/20/1",
		"https://github.com/torvalds/linux/commit/8cae8cd89f05f6de223d63e6d15e31c8ba9cf53b",
		"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.13.4",
		"http://packetstormsecurity.com/files/163621/Sequoia-A-Deep-Root-In-Linuxs-Filesystem-Layer.html",
		"http://packetstormsecurity.com/files/163671/Kernel-Live-Patch-Security-Notice-LSN-0079-1.html",
		"https://security.netapp.com/advisory/ntap-20210819-0004/",
		"http://packetstormsecurity.com/files/164155/Kernel-Live-Patch-Security-Notice-LSN-0081-1.html",
		"http://packetstormsecurity.com/files/165477/Kernel-Live-Patch-Security-Notice-LSN-0083-1.html"
	],
	"severity": "high",
	"state": "published",
	"_is_edited": false
}