{
	"id": "CVE-2017-15099",
	"description": "INSERT ... ON CONFLICT DO UPDATE commands in PostgreSQL 10.x before 10.1, 9.6.x before 9.6.6, and 9.5.x before 9.5.10 disclose table contents that the invoker lacks privilege to read. These exploits affect only tables where the attacker lacks full read access but has both INSERT and UPDATE privileges. Exploits bypass row level security policies and lack of SELECT privilege.\n\nAn access restriction bypass vulnerability has been discovered in PostgreSQL, the \"INSERT ... ON CONFLICT DO UPDATE\" would not check to see if the executing user had permission to perform a \"SELECT\" on the index performing the conflicting check. Additionally, in a table with row-level security enabled, the \"INSERT ... ON CONFLICT DO UPDATE\" would not check the SELECT policies for that table before performing the update.\r\nThe fix ensures that \"INSERT ... ON CONFLICT DO UPDATE\" checks against table permissions and RLS policies before executing.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "postgresql",
			"version": "< 10.1-1"
		},
		{
			"vendor": "archlinux",
			"product": "postgresql-old-upgrade",
			"version": "< 9.6.6-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "postgresql-9.6",
			"version": "< 9.6.6-0+deb9u1"
		}
	],
	"references": [
		"http://www.securityfocus.com/bid/101781",
		"https://access.redhat.com/errata/RHSA-2018:2511",
		"https://www.postgresql.org/support/security/",
		"http://www.securitytracker.com/id/1039752",
		"https://www.postgresql.org/about/news/1801/",
		"https://access.redhat.com/errata/RHSA-2018:2566",
		"https://www.debian.org/security/2017/dsa-4028"
	],
	"_edited_": false,
	"severity": "Medium"
}