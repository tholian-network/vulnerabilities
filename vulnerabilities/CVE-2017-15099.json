{
	"id": "CVE-2017-15099",
	"description": "An access restriction bypass vulnerability has been discovered in PostgreSQL, the \"INSERT ... ON CONFLICT DO UPDATE\" would not check to see if the executing user had permission to perform a \"SELECT\" on the index performing the conflicting check. Additionally, in a table with row-level security enabled, the \"INSERT ... ON CONFLICT DO UPDATE\" would not check the SELECT policies for that table before performing the update.\r\nThe fix ensures that \"INSERT ... ON CONFLICT DO UPDATE\" checks against table permissions and RLS policies before executing.",
	"hardware": [],
	"software": [
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-9",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-1.1",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-1.2",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-1.3",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-2",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-2.1",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-2.2",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-3",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-3.1",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-4",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-5",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-6",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-7",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-8",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-9",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-1.1",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-1.2",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-1.3",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-2",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-2.1",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-2.2",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-3",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-3.1",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-4",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-5",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-6",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-7",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-8",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-9",
			"version": "< 9.6.6-0+deb9u1"
		}
	],
	"references": [
		"https://www.postgresql.org/about/news/1801/",
		"https://security-tracker.debian.org/tracker/DSA-4028-1"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}