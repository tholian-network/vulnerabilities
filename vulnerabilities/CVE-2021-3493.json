{
	"id": "CVE-2021-3493",
	"description": "The overlayfs implementation in the linux kernel did not properly validate with respect to user namespaces the setting of file capabilities on files in an underlying file system. Due to the combination of unprivileged user namespaces along with a patch carried in the Ubuntu kernel to allow unprivileged overlay mounts, an attacker could use this to gain elevated privileges.\n\nAffected: Ubuntu linux kernel < 5.8.0-50.56 , <  5.4.0-72.80 , < 4.15.0-142.146 , <  4.4.0-209.241\n\nAffected: Ubuntu linux kernel <= 50.56, <= 72.80, <= 142.146, <= 209.241\n\nThe overlayfs stacking file system in Linux kernel does not properly validate the application of file capabilities against user namespaces, which could lead to privilege escalation.",
	"hardware": [],
	"software": [
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 0"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 0"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "*"
		}
	],
	"references": [
		"https://ubuntu.com/security/notices/USN-4917-1",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=7c03e2cda4a584cadc398e8f6641ca9988a39d52",
		"https://www.openwall.com/lists/oss-security/2021/04/16/1",
		"http://packetstormsecurity.com/files/162434/Kernel-Live-Patch-Security-Notice-LSN-0076-1.html",
		"http://packetstormsecurity.com/files/162866/Ubuntu-OverlayFS-Local-Privilege-Escalation.html",
		"http://packetstormsecurity.com/files/165151/Ubuntu-Overlayfs-Local-Privilege-Escalation.html"
	],
	"severity": "critical",
	"state": "invalid",
	"_is_edited": false
}