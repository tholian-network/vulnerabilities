{
	"id": "CVE-2021-40823",
	"description": "A logic error in the room key sharing functionality of matrix-js-sdk (aka Matrix Javascript SDK) before 12.4.1 allows a malicious Matrix homeserver present in an encrypted room to steal room encryption keys (via crafted Matrix protocol messages) that were originally sent by affected Matrix clients participating in that room. This allows the homeserver to decrypt end-to-end encrypted messages sent by affected clients.\n\nA security has been found in matrix-js-sdk before version 12.4.1, as used by Element Web/Desktop before version 1.8.4. In certain circumstances it may be possible to trick vulnerable clients into disclosing encryption keys for messages previously sent by that client to user accounts later compromised by an attacker.\r\n\r\nExploiting this vulnerability to read encrypted messages requires gaining control over the recipientâ€™s account. This requires either compromising their credentials directly or compromising their homeserver.\r\n\r\nThus, the greatest risk is to users who are in encrypted rooms containing malicious servers. Admins of malicious servers could attempt to impersonate their users' devices in order to spy on messages sent by vulnerable clients in that room.",
	"hardware": [],
	"software": [
		{
			"name": "element-desktop",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-web",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "node-matrix-js-sdk",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "node-matrix-js-sdk",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "element-desktop",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-web",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "node-matrix-js-sdk",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "node-matrix-js-sdk",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "element-desktop",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-web",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-desktop",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-web",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-desktop",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-web",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-desktop",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		},
		{
			"name": "element-web",
			"platform": "archlinux",
			"version": "< 1.8.4-1"
		}
	],
	"references": [
		"https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing/",
		"https://github.com/matrix-org/matrix-js-sdk/commit/894c24880da0e1cc81818f51c0db80e3c9fb2be9",
		"https://github.com/matrix-org/matrix-js-sdk/releases/tag/v12.4.1",
		"https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing"
	],
	"severity": "high",
	"state": "published",
	"_is_edited": false
}