{
	"id": "CVE-2021-37712",
	"description": "The npm package \"tar\" (aka node-tar) before versions 4.4.18, 5.0.10, and 6.1.9 has an arbitrary file creation/overwrite and arbitrary code execution vulnerability. node-tar aims to guarantee that any file whose location would be modified by a symbolic link is not extracted. This is, in part, achieved by ensuring that extracted directories are not symlinks. Additionally, in order to prevent unnecessary stat calls to determine whether a given path is a directory, paths are cached when directories are created. This logic was insufficient when extracting tar files that contained both a directory and a symlink with names containing unicode values that normalized to the same value. Additionally, on Windows systems, long path portions would resolve to the same file system entities as their 8.3 \"short path\" counterparts. A specially crafted tar archive could thus include a directory with one form of the path, followed by a symbolic link with a different string that resolves to the same file system entity, followed by a file using the first form. By first creating a directory, and then replacing that directory with a symlink that had a different apparent name that resolved to the same entry in the filesystem, it was thus possible to bypass node-tar symlink checks on directories, essentially allowing an untrusted tar file to symlink into an arbitrary location and subsequently extracting arbitrary files into that location, thus allowing arbitrary file creation and overwrite. These issues were addressed in releases 4.4.18, 5.0.10 and 6.1.9. The v3 branch of node-tar has been deprecated and did not receive patches for these issues. If you are still using a v3 release we recommend you update to a more recent version of node-tar. If this is not possible, a workaround is available in the referenced GHSA-qq89-hq3f-393p.\n\nAffected: npm node-tar < 4.4.18, >= 5.0.0, < 5.0.10, >= 6.0.0, < 6.1.9\n\nThe 'nodejs-lts-erbium' and 'nodejs-lts-fermium' core dependency 'node-tar' before versions 4.4.18, 5.0.10, and 6.1.9 is vulnerable to arbitrary file creation/overwrite and arbitrary code execution vulnerabilities.",
	"hardware": [],
	"software": [
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-12",
			"version": "< 6.1.11+~cs11.3.10-1"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-12",
			"version": "< 6.1.11+~cs11.3.10-1"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-12",
			"version": "< 6.1.11+~cs11.3.10-1"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-1.3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-2.2",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-3.1",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-4",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-5",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-6",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-7",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-8",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-9",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-12",
			"version": "< 6.1.11+~cs11.3.10-1"
		},
		{
			"name": "node-tar",
			"platform": "debian-11",
			"version": "< 6.0.5+ds1+~cs11.3.9-1+deb11u2"
		},
		{
			"name": "node-tar",
			"platform": "debian-10",
			"version": "*"
		}
	],
	"references": [
		"https://nodejs.org/en/blog/vulnerability/aug-2021-security-releases2/",
		"https://github.com/npm/node-tar/security/advisories/GHSA-qq89-hq3f-393p",
		"https://security-tracker.debian.org/tracker/DSA-5008-1",
		"https://www.npmjs.com/package/tar",
		"https://www.oracle.com/security-alerts/cpuoct2021.html",
		"https://www.debian.org/security/2021/dsa-5008",
		"https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf"
	],
	"severity": "high",
	"state": "invalid",
	"_is_edited": false
}