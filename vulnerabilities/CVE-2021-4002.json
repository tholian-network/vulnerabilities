{
	"id": "CVE-2021-4002",
	"description": "A memory leak flaw in the Linux kernel's hugetlbfs memory usage was found in the way the user maps some regions of memory twice using shmget() which are aligned to PUD alignment with the fault of some of the memory pages. A local user could use this flaw to get unauthorized access to some data.\n\nOn the Linux kernel 3.6 and later before version 5.15.5, it is possible for an attacker to leak or change data that resides on hugetlbfs. Such data can reside on hugetlbfs, for instance if the victim runs mmap() using the MAP_HUGETLB or shmget() with SHM_HUGETLB. If a victim maps executable code onto hugetlbfs, the executable can be modified as well.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "linux-hardened",
			"version": "< 5.15.5.hardened1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux",
			"version": "< 5.15.5.arch1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-zen",
			"version": "< 5.15.5.zen1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-lts",
			"version": "< 5.10.82-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "linux",
			"version": "< 5.15.5-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "linux",
			"version": "< 5.10.84-1"
		},
		{
			"vendor": "debian-buster",
			"product": "linux",
			"version": "< 4.19.232-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "linux",
			"version": "< 4.9.303-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "linux-4.19",
			"version": "< 4.19.232-1~deb9u1"
		}
	],
	"references": [
		"https://bugzilla.redhat.com/show_bug.cgi?id=2025726",
		"https://www.openwall.com/lists/oss-security/2021/11/25/1",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=13e4ad2ce8df6e058ef482a31fdd81c725b0f7ea",
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a4a118f2eead1d6c49e00765de89878288d4b890",
		"https://lists.debian.org/debian-lts-announce/2022/03/msg00011.html",
		"https://lists.debian.org/debian-lts-announce/2022/03/msg00012.html",
		"https://www.debian.org/security/2022/dsa-5096",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.15.5&id=556d59293a2a94863797a7a50890992aa5e8db16",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.82&id=40bc831ab5f630431010d1ff867390b07418a7ee"
	],
	"_edited_": false,
	"severity": "Medium"
}