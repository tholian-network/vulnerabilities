{
	"id": "CVE-2018-12892",
	"description": "An issue was discovered in Xen 4.7 through 4.10.x. libxl fails to pass the readonly flag to qemu when setting up a SCSI disk, due to what was probably an erroneous merge conflict resolution. Malicious guest administrators or (in some situations) users may be able to write to supposedly read-only disk images. Only emulated SCSI disks (specified as \"sd\" in the libxl disk configuration, or an equivalent) are affected. IDE disks (\"hd\") are not affected (because attempts to make them readonly are rejected). Additionally, CDROM devices (that is, devices specified to be presented to the guest as CDROMs, regardless of the nature of the backing storage on the host) are not affected; they are always read only. Only systems using qemu-xen (rather than qemu-xen-traditional) as the device model version are vulnerable. Only systems using libxl or libxl-based toolstacks are vulnerable. (This includes xl, and libvirt with the libxl driver.) The vulnerability is present in Xen versions 4.7 and later. (In earlier versions, provided that the patch for XSA-142 has been applied, attempts to create read only disks are rejected.) If the host and guest together usually support PVHVM, the issue is exploitable only if the malicious guest administrator has control of the guest kernel or guest kernel command line.",
	"hardware": [],
	"software": [
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-12",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-11",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-10",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-12",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-11",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-10",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-12",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-11",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-10",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-9",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-1.3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-2.2",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-3.1",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-4",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-5",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-6",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-7",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-8",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-12",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-11",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		},
		{
			"name": "xen",
			"platform": "debian-10",
			"version": "< 4.8.3+xsa267+shim4.10.1+xsa267-1+deb9u9"
		}
	],
	"references": [
		"https://security-tracker.debian.org/tracker/DSA-4236-1",
		"https://www.debian.org/security/2018/dsa-4236",
		"https://security.gentoo.org/glsa/201810-06",
		"http://www.securityfocus.com/bid/104571",
		"http://xenbits.xen.org/xsa/advisory-266.html",
		"http://www.securitytracker.com/id/1041203",
		"http://www.openwall.com/lists/oss-security/2018/06/27/12"
	],
	"severity": null,
	"state": "published",
	"_is_edited": false
}