{
	"id": "CVE-2017-12172",
	"description": "PostgreSQL 10.x before 10.1, 9.6.x before 9.6.6, 9.5.x before 9.5.10, 9.4.x before 9.4.15, 9.3.x before 9.3.20, and 9.2.x before 9.2.24 runs under a non-root operating system account, and database superusers have effective ability to run arbitrary code under that system account. PostgreSQL provides a script for starting the database server during system boot. Packages of PostgreSQL for many operating systems provide their own, packager-authored startup implementations. Several implementations use a log file name that the database superuser can replace with a symbolic link. As root, they open(), chmod() and/or chown() this log file name. This often suffices for the database superuser to escalate to root privileges when root starts the server.\n\nAffected: Red Hat, Inc. postgresql 10.x before 10.1, 9.6.x before 9.6.6, 9.5.x before 9.5.10, 9.4.x before 9.4.15, 9.3.x before 9.3.20, 9.2.x before 9.2.24\n\nA vulnerability has been discovered in PostgreSQL when the startup log file for the postmaster (in newer releases, \"postgres\") process was opened while the process was still owned by root. With this setup, the database owner could specify a file that they did not have access to and cause the file to be corrupted with logged data. This vulnerability allows database administrator to modify root-owned files and therefor potentially leads to privilege escalation.\r\nThe fix ensures that the startup log file is opened as the user specified to run the PostgreSQL server. Any users who have made use of the start scripts will need to ensure the startup log files are owned by the user specified to run the PostgreSQL server.",
	"hardware": [],
	"software": [
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-9",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		},
		{
			"name": "postgresql-9.6",
			"platform": "debian-9",
			"version": "< 9.6.6-0+deb9u1"
		},
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		},
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		},
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		},
		{
			"name": "postgresql-old-upgrade",
			"platform": "archlinux",
			"version": "< 9.6.6-1"
		},
		{
			"name": "postgresql",
			"platform": "archlinux",
			"version": "< 10.1-1"
		}
	],
	"references": [
		"https://www.postgresql.org/about/news/1801/",
		"https://access.redhat.com/errata/RHSA-2017:3402",
		"http://www.securityfocus.com/bid/101949",
		"https://access.redhat.com/errata/RHSA-2017:3403",
		"https://access.redhat.com/errata/RHSA-2017:3405",
		"https://www.postgresql.org/support/security/",
		"http://www.securitytracker.com/id/1039752",
		"https://access.redhat.com/errata/RHSA-2017:3404"
	],
	"severity": "high",
	"state": "invalid",
	"_is_edited": false
}