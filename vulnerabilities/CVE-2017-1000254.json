{
	"id": "CVE-2017-1000254",
	"description": "libcurl may read outside of a heap allocated buffer when doing FTP. When libcurl connects to an FTP server and successfully logs in (anonymous or not), it asks the server for the current directory with the `PWD` command. The server then responds with a 257 response containing the path, inside double quotes. The returned path name is then kept by libcurl for subsequent uses. Due to a flaw in the string parser for this directory name, a directory name passed like this but without a closing double quote would lead to libcurl not adding a trailing NUL byte to the buffer holding the name. When libcurl would then later access the string, it could read beyond the allocated heap buffer and crash or wrongly access data beyond the buffer, thinking it was part of the path. A malicious server could abuse this fact and effectively prevent libcurl-based clients to work with it - the PWD command is always issued on new FTP connections and the mistake has a high chance of causing a segfault. The simple fact that this has issue remained undiscovered for this long could suggest that malformed PWD responses are rare in benign servers. We are not aware of any exploit of this flaw. This bug was introduced in commit [415d2e7cb7](https://github.com/curl/curl/commit/415d2e7cb7), March 2005. In libcurl version 7.56.0, the parser always zero terminates the string but also rejects it if not terminated properly with a final double quote.",
	"hardware": [],
	"software": [
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.56.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "< 7.56.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "< 7.56.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.38.0-4+deb8u6"
		},
		{
			"name": "curl",
			"platform": "debian-1.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-1.3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-2.2",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-3.1",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-4",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-5",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-6",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-7",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-8",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "debian-12",
			"version": "< 7.56.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-11",
			"version": "< 7.56.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-10",
			"version": "< 7.56.1-1"
		},
		{
			"name": "curl",
			"platform": "debian-9",
			"version": "< 7.52.1-5+deb9u1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-compat",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-libcurl-gnutls",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		},
		{
			"name": "lib32-curl",
			"platform": "archlinux",
			"version": "< 7.56.0-1"
		}
	],
	"references": [
		"https://curl.haxx.se/docs/adv_20171004.html",
		"https://curl.haxx.se/CVE-2017-1000254.patch",
		"https://github.com/curl/curl/commit/5ff2c5ff25750aba1a8f64fbcad8e5b891512584",
		"https://security-tracker.debian.org/tracker/DSA-3992-1",
		"https://security.gentoo.org/glsa/201712-04",
		"https://access.redhat.com/errata/RHSA-2018:3558",
		"https://support.apple.com/HT208331",
		"http://www.securitytracker.com/id/1039509",
		"https://curl.haxx.se/673d0cd8.patch",
		"https://access.redhat.com/errata/RHSA-2018:2486",
		"http://www.debian.org/security/2017/dsa-3992",
		"http://www.securityfocus.com/bid/101115",
		"https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4%40%3Cissues.bookkeeper.apache.org%3E",
		"https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b%40%3Cissues.bookkeeper.apache.org%3E"
	],
	"severity": "low",
	"state": "published",
	"_is_edited": false
}