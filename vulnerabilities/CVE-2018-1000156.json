{
	"id": "CVE-2018-1000156",
	"description": "GNU Patch version 2.7.6 contains an input validation vulnerability when processing patch files, specifically the EDITOR_PROGRAM invocation (using ed) can result in code execution. This attack appear to be exploitable via a patch file processed via the patch utility. This is similar to FreeBSD's CVE-2015-1418 however although they share a common ancestry the code bases have diverged over time.\n\nAn arbitrary command execution vulnerability has been found in patch versions prior to 2.7.7 when applying ed-style patches. Due to insufficient sanitization of the input patch stream, it is possible for a patch file to cause patch to pass certain ed scripts to the ed editor, which would run commands. This issue could be exploited to execute arbitrary commands as the user invoking patch against a specially crafted patch file, which could be leveraged to obtain elevated privileges.",
	"hardware": [],
	"software": [
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "debian-12",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-11",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-10",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-9",
			"version": "< 2.7.5-1+deb9u1"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "debian-12",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-11",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-10",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-9",
			"version": "< 2.7.5-1+deb9u1"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "debian-12",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-11",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-10",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-7"
		},
		{
			"name": "patch",
			"platform": "archlinux",
			"version": "< 2.7.6-3"
		},
		{
			"name": "patch",
			"platform": "debian-12",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-11",
			"version": "< 2.7.6-2"
		},
		{
			"name": "patch",
			"platform": "debian-10",
			"version": "< 2.7.6-2"
		}
	],
	"references": [
		"https://savannah.gnu.org/bugs/?53566",
		"https://git.savannah.gnu.org/cgit/patch.git/commit/?id=123eaff0d5d1aebe128295959435b9ca5909c26d",
		"https://git.savannah.gnu.org/cgit/patch.git/commit/?id=3fcd042d26d70856e826a42b5f93dc4854d80bf0",
		"https://savannah.gnu.org/bugs/index.php?53566",
		"https://lists.debian.org/debian-lts-announce/2018/04/msg00013.html",
		"https://usn.ubuntu.com/3624-2/",
		"https://usn.ubuntu.com/3624-1/",
		"https://twitter.com/kurtseifried/status/982028968877436928",
		"http://rachelbythebay.com/w/2018/04/05/bangpatch/",
		"https://access.redhat.com/errata/RHSA-2018:2091",
		"https://access.redhat.com/errata/RHSA-2018:2094",
		"https://access.redhat.com/errata/RHSA-2018:2093",
		"https://access.redhat.com/errata/RHSA-2018:1200",
		"https://access.redhat.com/errata/RHSA-2018:2095",
		"https://access.redhat.com/errata/RHSA-2018:1199",
		"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=894667#19",
		"https://access.redhat.com/errata/RHSA-2018:2092",
		"https://access.redhat.com/errata/RHSA-2018:2097",
		"https://access.redhat.com/errata/RHSA-2018:2096",
		"https://security.gentoo.org/glsa/201904-17",
		"https://seclists.org/bugtraq/2019/Jul/54",
		"https://seclists.org/bugtraq/2019/Aug/29",
		"http://packetstormsecurity.com/files/154124/GNU-patch-Command-Injection-Directory-Traversal.html"
	],
	"severity": "high",
	"state": "published",
	"_is_edited": false
}