{
	"id": "CVE-2021-40346",
	"description": "A bug has been found in the HTTP header name length encoding in the HTX representation of haproxy, by which the most significant bit of the name's length can slip into the value's least significant bit. A remote attacker could craft a valid request that could inject a dummy content-length on input that would be produced on output in addition to the other one, resulting in the possibility of a blind request smuggling attack (\"blind\" because the response never gets back to the attacker).",
	"hardware": [],
	"software": [
		{
			"name": "haproxy",
			"platform": "archlinux",
			"version": "< 2.4.4-1"
		},
		{
			"name": "haproxy",
			"platform": "debian-11",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-1.1",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-1.2",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-1.3",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-2",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-2.1",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-2.2",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-3",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-3.1",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-4",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-5",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-6",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-7",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-8",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-9",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-10",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-11",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-1.1",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-1.2",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-1.3",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-2",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-2.1",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-2.2",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-3",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-3.1",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-4",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-5",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-6",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-7",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-8",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-9",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-10",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-12",
			"version": "< 2.2.16-3"
		},
		{
			"name": "haproxy",
			"platform": "debian-11",
			"version": "< 2.2.9-2+deb11u2"
		},
		{
			"name": "haproxy",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "haproxy",
			"platform": "debian-9",
			"version": "< 0"
		}
	],
	"references": [
		"https://www.mail-archive.com/haproxy@formilux.org/msg41114.html",
		"https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/",
		"https://github.com/haproxy/haproxy/commit/3b69886f7dcc3cfb3d166309018e6cfec9ce2c95",
		"https://security-tracker.debian.org/tracker/DSA-4968-1"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}