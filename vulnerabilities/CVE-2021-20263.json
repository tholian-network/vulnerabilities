{
	"id": "CVE-2021-20263",
	"description": "A flaw was found in the virtio-fs shared file system daemon (virtiofsd) of QEMU. The new 'xattrmap' option may cause the 'security.capability' xattr in the guest to not drop on file write, potentially leading to a modified, privileged executable in the guest. In rare circumstances, this flaw could be used by a malicious user to elevate their privileges within the guest.\n\nAffected: n/a QEMU qemu 5.2.50\n\nA security issue was found in in the virtio-fs shared file system daemon (virtiofsd) of QEMU. Virtio-fs is meant to share a host file system directory with a guest virtual machine. The new 'xattrmap' option may cause the 'security.capability' xattr in the guest to not drop on file write, potentially leading to a modified, privileged executable in the guest. In rare circumstances, this flaw could be used by a malicious user to elevate their privileges within the guest.\r\n\r\nFor the problem to happen virtiofsd needs to be running with '-o xattr' and '-o xattrmap' (to enable and rename xattrs, respectively). The problem only occurs if 'security.capability' is one of the xattrs that is being renamed. Different caching modes cause different guest behavior: '-o cache=none' makes the issue easy to reproduce. There's a suspicion the flaw could be reproduced with the default option '-o cache=auto' as well.\r\n\r\nThe impact of this flaw is limited by the fact that xattrmap is a recent feature that's little used so far. Additionally, unprivileged users shouldn't be granted write permission on privileged executables in the first place.",
	"hardware": [],
	"software": [
		{
			"name": "qemu",
			"platform": "archlinux",
			"version": "< 6.0.0-1"
		},
		{
			"name": "qemu",
			"platform": "debian-12",
			"version": "< 1:5.2+dfsg-9"
		},
		{
			"name": "qemu",
			"platform": "debian-11",
			"version": "< 1:5.2+dfsg-9"
		},
		{
			"name": "qemu",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "qemu",
			"platform": "debian-9",
			"version": "< 0"
		},
		{
			"name": "qemu",
			"platform": "archlinux",
			"version": "< 6.0.0-1"
		},
		{
			"name": "qemu",
			"platform": "debian-12",
			"version": "< 1:5.2+dfsg-9"
		},
		{
			"name": "qemu",
			"platform": "debian-11",
			"version": "< 1:5.2+dfsg-9"
		},
		{
			"name": "qemu",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "qemu",
			"platform": "debian-9",
			"version": "< 0"
		},
		{
			"name": "qemu",
			"platform": "archlinux",
			"version": "< 6.0.0-1"
		},
		{
			"name": "qemu",
			"platform": "archlinux",
			"version": "< 6.0.0-1"
		},
		{
			"name": "qemu",
			"platform": "archlinux",
			"version": "< 6.0.0-1"
		},
		{
			"name": "qemu",
			"platform": "archlinux",
			"version": "< 6.0.0-1"
		}
	],
	"references": [
		"https://www.openwall.com/lists/oss-security/2021/03/08/1",
		"https://bugzilla.redhat.com/show_bug.cgi?id=1933668",
		"https://git.qemu.org/?p=qemu.git;a=commitdiff;h=e586edcb410543768ef009eaa22a2d9dd4a53846",
		"https://security.netapp.com/advisory/ntap-20210507-0002/"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}