{
	"id": "CVE-2018-16151",
	"description": "In verify_emsa_pkcs1_signature() in gmp_rsa_public_key.c in the gmp plugin in strongSwan 4.x and 5.x before 5.7.0, the RSA implementation based on GMP does not reject excess data after the encoded algorithm OID during PKCS#1 v1.5 signature verification. Similar to the flaw in the same version of strongSwan regarding digestAlgorithm.parameters, a remote attacker can forge signatures when small public exponents are being used, which could lead to impersonation when only an RSA signature is used for IKEv2 authentication.\n\nThe OID parser allows any number of random bytes after a valid OID for a PKCS#1.5 signature. The asn1_known_oid() function just parses until it finds a leaf in the tree of known OIDs, any further data that follows is simply ignored. And the function that parses ASN.1 algorithmIdentifier structures doesn't care if the full OID data was parsed as it usually doesn't really matter. A missing check to reject junk and random key parameters allows attackers to carry out a Bleichenbacher-style attack on low-exponent keys and create forged signatures.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "strongswan",
			"version": "< 5.7.0-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "strongswan",
			"version": "< 5.7.0-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "strongswan",
			"version": "< 5.7.0-1"
		},
		{
			"vendor": "debian-buster",
			"product": "strongswan",
			"version": "< 5.7.0-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "strongswan",
			"version": "< 5.5.1-4+deb9u3"
		}
	],
	"references": [
		"https://www.debian.org/security/2018/dsa-4305",
		"https://security.gentoo.org/glsa/201811-16",
		"https://www.strongswan.org/blog/2018/09/24/strongswan-vulnerability-%28cve-2018-16151%2C-cve-2018-16152%29.html",
		"https://lists.debian.org/debian-lts-announce/2018/09/msg00032.html",
		"https://usn.ubuntu.com/3771-1/",
		"http://lists.opensuse.org/opensuse-security-announce/2019-11/msg00077.html",
		"http://lists.opensuse.org/opensuse-security-announce/2019-12/msg00001.html",
		"http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00047.html",
		"https://github.com/strongswan/strongswan/commit/5955db5b124a1ee5f44c0845b6e00c86fddae67c"
	],
	"_edited_": false,
	"severity": "High"
}