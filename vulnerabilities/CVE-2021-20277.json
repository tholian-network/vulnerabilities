{
	"id": "CVE-2021-20277",
	"description": "A flaw was found in Samba's libldb. Multiple, consecutive leading spaces in an LDAP attribute can lead to an out-of-bounds memory write, leading to a crash of the LDAP server process handling the request. The highest threat from this vulnerability is to system availability.\n\nA security issue has been found in Samba before version 4.14.2. A string in an LDAP attribute that contains multiple consecutive leading spaces can lead to a memmove() of out of bounds memory in ldb_handler_fold(). ldb_handler_fold() is used by case insensitive strings - that is most string attributes - in Active Directory. As the search expression is normalised prior to matching any potential objects this in turn may crash the LDAP server process handling the request. It may be possible to leak the out of bounds memory by matching against it, but this is thought to be unlikely.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "samba",
			"version": "< 4.14.2-1"
		},
		{
			"vendor": "archlinux",
			"product": "ldb",
			"version": "< 1:2.3.0-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "ldb",
			"version": "< 2:2.2.0-3.1"
		},
		{
			"vendor": "debian-buster",
			"product": "ldb",
			"version": "< 2:1.5.1+really1.4.6-3+deb10u1"
		},
		{
			"vendor": "debian-stretch",
			"product": "ldb",
			"version": "< 2:1.1.27-1+deb9u2"
		}
	],
	"references": [
		"https://security.netapp.com/advisory/ntap-20210326-0007/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/X5J3B6PN5XMXF3OHYBNHDKZ3XFSUGY4L/",
		"https://lists.debian.org/debian-lts-announce/2021/03/msg00036.html",
		"https://www.debian.org/security/2021/dsa-4884",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZXP3ONIY6MB4C5LDZV4YL5KJCES3UX24/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VLZ74IF2N75VQSIHBL4B3P5WKWQCXSRY/",
		"https://bugzilla.redhat.com/show_bug.cgi?id=1941402",
		"https://www.samba.org/samba/security/CVE-2021-20277.html",
		"https://security.gentoo.org/glsa/202105-22",
		"https://bugzilla.samba.org/show_bug.cgi?id=14655",
		"https://www.samba.org/samba/ftp/patches/security/samba-4.14.0-security-2021-03-24.patch",
		"https://git.samba.org/samba.git/?p=samba.git;a=commitdiff;h=1d966cb12e7882f9cfb230195e4eff3de0f4e135",
		"https://git.samba.org/samba.git/?p=samba.git;a=commitdiff;h=50e44877c3df8098658bd4b1fdad25b8aaadf6f3",
		"https://git.samba.org/samba.git/?p=samba.git;a=commitdiff;h=fab6b79b7724f0b636963be528483e3e946884aa"
	],
	"_edited_": false,
	"severity": "Medium"
}