{
	"id": "CVE-2021-3490",
	"description": "The eBPF ALU32 bounds tracking for bitwise ops (AND, OR and XOR) in the Linux kernel did not properly update 32-bit bounds, which could be turned into out of bounds reads and writes in the Linux kernel and therefore, arbitrary code execution. This issue was fixed via commit 049c4e13714e (\"bpf: Fix alu32 const subreg bound tracking on bitwise operations\") (v5.13-rc4) and backported to the stable kernels in v5.12.4, v5.11.21, and v5.10.37. The AND/OR issues were introduced by commit 3f50f132d840 (\"bpf: Verifier, do explicit ALU32 bounds tracking\") (5.7-rc1) and the XOR variant was introduced by 2921c90d4718 (\"bpf:Fix a verifier failure with xor\") ( 5.10-rc1).\n\nAffected: Linux Linux kernel < v5.13-rc4, < v5.12.4, < v5.11.21, < v5.10.37, < 5.7*\n\nA security issue was found in the Linux kernel before version 5.12.4. It was discovered that eBPF ALU32 bounds tracking for bitwise ops (AND, OR and XOR) did not update the 32-bit bounds, leading to out-of-bounds reads and writes in the kernel.",
	"hardware": [],
	"software": [
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.37-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.11.21.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.12.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.12.4.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 0"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.37-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.11.21.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.12.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.12.4.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.38-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 0"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 0"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.37-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.11.21.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.12.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.12.4.arch1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.37-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.11.21.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.12.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.12.4.arch1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.37-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.11.21.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.12.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.12.4.arch1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.37-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.11.21.hardened1-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.12.4.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.12.4.arch1-1"
		}
	],
	"references": [
		"https://www.openwall.com/lists/oss-security/2021/05/11/11",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.12.4&id=9fdd1d10daac186e21a77290f9d22b41e175e1b9",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.11.21&id=3a0066086a338f99205b1c38c9fbefaeb5cd6d28",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.37&id=282bfc8848eaa195d5e994bb700f2c7afb7eb3e6",
		"https://ubuntu.com/security/notices/USN-4950-1",
		"https://ubuntu.com/security/notices/USN-4949-1",
		"https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=049c4e13714ecbca567b4d5f6d563f05d431c80e",
		"https://www.zerodayinitiative.com/advisories/ZDI-21-606/",
		"https://security.netapp.com/advisory/ntap-20210716-0004/",
		"http://packetstormsecurity.com/files/164015/Linux-eBPF-ALU32-32-bit-Invalid-Bounds-Tracking-Local-Privilege-Escalation.html"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}