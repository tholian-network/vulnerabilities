{
	"id": "CVE-2017-1000083",
	"description": "backend/comics/comics-document.c (aka the comic book backend) in GNOME Evince before 3.24.1 allows remote attackers to execute arbitrary commands via a .cbt file that is a TAR archive containing a filename beginning with a \"--\" command-line option substring, as demonstrated by a --checkpoint-action=exec=bash at the beginning of the filename.\n\nThe comic book backend in evince <= 3.24.0 is vulnerable to a command injection bug that can be used to execute arbitrary commands when a cbt file is opened.\r\nCBT files are simple tar archives containing images. When a cbt file is processed, evince calls \"tar -xOf $archive $filename\" for every image file in the archive. While both the archive name and the filename are quoted to not be interpreted by the shell, the filename is completely attacker controlled an can start with \"--\" which leads to tar interpreting it as a command line flag. This can be exploited by creating a tar archive with an embedded file named something like this: \"--checkpoint-action=exec=bash -c 'touch ~/covfefe.evince;'.jpg\"\r\nThis can presumably be triggered by the evince thumbnailer, which is not sandboxed, and web browsers that allow untrusted websites to auto-downloading files without user interaction (Chrome, Epiphany) can trigger the thumbnailer to run so this is web exposed.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "evince",
			"version": "< 3.24.0+12+g717df38f-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "atril",
			"version": "< 1.16.1-2.1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "atril",
			"version": "< 1.16.1-2.1"
		},
		{
			"vendor": "debian-buster",
			"product": "atril",
			"version": "< 1.16.1-2.1"
		},
		{
			"vendor": "debian-stretch",
			"product": "atril",
			"version": "< 1.16.1-2+deb9u1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "evince",
			"version": "< 3.22.1-4"
		},
		{
			"vendor": "debian-bullseye",
			"product": "evince",
			"version": "< 3.22.1-4"
		},
		{
			"vendor": "debian-buster",
			"product": "evince",
			"version": "< 3.22.1-4"
		},
		{
			"vendor": "debian-stretch",
			"product": "evince",
			"version": "< 3.22.1-3+deb9u1"
		}
	],
	"references": [
		"https://www.exploit-db.com/exploits/46341/",
		"http://seclists.org/oss-sec/2017/q3/128",
		"https://github.com/GNOME/evince/commit/717df38fd8509bf883b70d680c9b1b3cf36732ee",
		"https://bugzilla.gnome.org/show_bug.cgi?id=784630",
		"http://www.securityfocus.com/bid/99597",
		"https://access.redhat.com/errata/RHSA-2017:2388",
		"http://www.debian.org/security/2017/dsa-3911",
		"https://www.exploit-db.com/exploits/45824/",
		"https://git.gnome.org/browse/evince/commit/?h=gnome-3-24&id=717df38fd8509bf883b70d680c9b1b3cf36732ee"
	],
	"_edited_": false,
	"severity": "Critical"
}