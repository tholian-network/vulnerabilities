{
	"id": "CVE-2021-3682",
	"description": "A flaw was found in the USB redirector device emulation of QEMU in versions prior to 6.1.0-rc2. It occurs when dropping packets during a bulk transfer from a SPICE client due to the packet queue being full. A malicious SPICE client could use this flaw to make QEMU call free() with faked heap chunk metadata, resulting in a crash of QEMU or potential code execution with the privileges of the QEMU process on the host.\n\nA security issue was found in the USB redirector device emulation of QEMU. It occurs when dropping packets during a bulk transfer from a SPICE client due to the packet queue being full. A malicious SPICE client could use this flaw to make QEMU call free() with faked heap chunk metadata, resulting in a crash of QEMU or potential code execution with the privileges of the QEMU process on the host.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "qemu",
			"version": "< 6.1.0-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "qemu",
			"version": "< 1:6.0+dfsg-3"
		},
		{
			"vendor": "debian-bullseye",
			"product": "qemu",
			"version": "< 1:5.2+dfsg-11+deb11u1"
		},
		{
			"vendor": "debian-stretch",
			"product": "qemu",
			"version": "< 1:2.8+dfsg-6+deb9u15"
		}
	],
	"references": [
		"https://bugzilla.redhat.com/show_bug.cgi?id=1989651",
		"https://security.netapp.com/advisory/ntap-20210902-0006/",
		"https://lists.debian.org/debian-lts-announce/2021/09/msg00000.html",
		"https://www.debian.org/security/2021/dsa-4980",
		"https://gitlab.com/qemu-project/qemu/-/issues/491",
		"https://gitlab.com/qemu-project/qemu/-/commit/5e796671e6b8d5de4b0b423dce1b3eba144a92c9"
	],
	"_edited_": false,
	"severity": "Medium"
}