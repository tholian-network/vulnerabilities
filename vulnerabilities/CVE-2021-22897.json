{
	"id": "CVE-2021-22897",
	"description": "curl 7.61.0 through 7.76.1 suffers from exposure of data element to wrong session due to a mistake in the code for CURLOPT_SSL_CIPHER_LIST when libcurl is built to use the Schannel TLS library. The selected cipher set was stored in a single \"static\" variable in the library, which has the surprising side-effect that if an application sets up multiple concurrent transfers, the last one that sets the ciphers will accidentally control the set used by all transfers. In a worst-case scenario, this weakens transport security significantly.\n\nA security issue has been found in curl before version 7.77.0. libcurl lets applictions specify which specific TLS ciphers to use in transfers, using the option called CURLOPT_SSL_CIPHER_LIST. The cipher selection is used for the TLS negotation when a transfer is done involving any of the TLS based transfer protocols libcurl supports, such as HTTPS, FTPS, IMAPS, POP3S, SMTPS etc.\r\n\r\nDue to a mistake in the code, the selected cipher set was stored in a single \"static\" variable in the library, which has the surprising side-effect that if an application sets up multiple concurrent transfers, the last one that sets the ciphers will accidentally control the set used by all transfers. In a worst-case scenario, this weakens transport security significantly.\r\n\r\nThis flaw can only trigger when Schannel is used, which is the native TLS library in Microsoft Windows.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "curl",
			"version": "< 7.77.0-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "curl",
			"version": "< 0"
		},
		{
			"vendor": "debian-bullseye",
			"product": "curl",
			"version": "< 0"
		},
		{
			"vendor": "debian-buster",
			"product": "curl",
			"version": "< 0"
		},
		{
			"vendor": "debian-stretch",
			"product": "curl",
			"version": "< 0"
		}
	],
	"references": [
		"https://hackerone.com/reports/1172857",
		"https://curl.se/docs/CVE-2021-22897.html",
		"https://github.com/curl/curl/commit/bbb71507b7bab52002f9b1e0880bed6a32834511",
		"https://www.oracle.com//security-alerts/cpujul2021.html",
		"https://www.oracle.com/security-alerts/cpujan2022.html",
		"https://security.netapp.com/advisory/ntap-20210727-0007/",
		"https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf"
	],
	"_edited_": false,
	"severity": "Low"
}