{
	"id": "CVE-2019-20382",
	"description": "QEMU 4.1.0 has a memory leak in zrle_compress_data in ui/vnc-enc-zrle.c during a VNC disconnect operation because libz is misused, resulting in a situation where memory allocated in deflateInit2 is not freed in deflateEnd.\n\nA memory leak has been found in in the way VNC display driver of QEMU <= 4.2.0 handled connection disconnect, when ZRLE, Tight encoding is enabled. It creates two vncState objects, one of which allocates memory for Zlib's data object. This allocated memory is not free'd upon disconnection resulting in the said memory leakage issue.\r\nA user able to connect to the VNC server could use this flaw to leak host memory leading to a potential DoS scenario.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "qemu",
			"version": "< 5.0.0-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "qemu",
			"version": "< 1:4.2-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "qemu",
			"version": "< 1:4.2-1"
		},
		{
			"vendor": "debian-buster",
			"product": "qemu",
			"version": "< 1:3.1+dfsg-8+deb10u5"
		},
		{
			"vendor": "debian-stretch",
			"product": "qemu",
			"version": "< 1:2.8+dfsg-6+deb9u10"
		}
	],
	"references": [
		"https://git.qemu.org/?p=qemu.git%3Ba=commit%3Bh=6bf21f3d83e95bcc4ba35a7a07cc6655e8b010b0",
		"http://www.openwall.com/lists/oss-security/2020/03/05/1",
		"http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00007.html",
		"https://www.debian.org/security/2020/dsa-4665",
		"https://usn.ubuntu.com/4372-1/",
		"https://lists.debian.org/debian-lts-announce/2020/07/msg00020.html",
		"https://git.qemu.org/?p=qemu.git;a=commitdiff;h=6bf21f3d83e95bcc4ba35a7a07cc6655e8b010b0"
	],
	"_edited_": false,
	"severity": "Low"
}