{
	"id": "CVE-2019-6974",
	"description": "In the Linux kernel before 4.20.8, kvm_ioctl_create_device in virt/kvm/kvm_main.c mishandles reference counting because of a race condition, leading to a use-after-free.\n\nA use-after-free vulnerability was found in the way the Linux kernel's KVM hypervisor implements its device control API. While creating a device via kvm_ioctl_create_device(), the device holds a reference to a VM object, later this reference is transferred to the caller's file descriptor table. If such file descriptor was to be closed, reference count to the VM object could become zero, potentially leading to a use-after-free issue. A user/process could use this flaw to crash the guest VM resulting in a denial of service issue or, potentially, gain privileged access to a system.",
	"hardware": [],
	"software": [
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.161-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.161-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 4.20.8.arch1-1"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 4.19.20-1"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.20-1"
		}
	],
	"references": [
		"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=cfa39381173d5f969daf43582c95ad679189cbc9",
		"https://bugs.chromium.org/p/project-zero/issues/detail?id=1765",
		"https://www.exploit-db.com/exploits/46388",
		"https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.14.99",
		"https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.19.21",
		"https://www.exploit-db.com/exploits/46388/",
		"https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.20.8",
		"https://github.com/torvalds/linux/commit/cfa39381173d5f969daf43582c95ad679189cbc9",
		"http://www.securityfocus.com/bid/107127",
		"https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.9.156",
		"http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=cfa39381173d5f969daf43582c95ad679189cbc9",
		"https://lists.debian.org/debian-lts-announce/2019/03/msg00034.html",
		"https://lists.debian.org/debian-lts-announce/2019/04/msg00004.html",
		"https://usn.ubuntu.com/3932-1/",
		"https://usn.ubuntu.com/3932-2/",
		"https://usn.ubuntu.com/3930-1/",
		"https://usn.ubuntu.com/3931-1/",
		"https://usn.ubuntu.com/3933-2/",
		"https://usn.ubuntu.com/3931-2/",
		"https://usn.ubuntu.com/3930-2/",
		"https://usn.ubuntu.com/3933-1/",
		"https://support.f5.com/csp/article/K11186236",
		"https://access.redhat.com/errata/RHSA-2019:0833",
		"https://access.redhat.com/errata/RHSA-2019:0818",
		"https://lists.debian.org/debian-lts-announce/2019/05/msg00002.html",
		"https://access.redhat.com/errata/RHBA-2019:0959",
		"https://access.redhat.com/errata/RHSA-2019:2809",
		"https://support.f5.com/csp/article/K11186236?utm_source=f5support&amp%3Butm_medium=RSS",
		"https://access.redhat.com/errata/RHSA-2019:3967",
		"https://access.redhat.com/errata/RHSA-2020:0103"
	],
	"severity": "high",
	"state": "published",
	"_is_edited": false
}