{
	"id": "CVE-2019-12209",
	"description": "Yubico pam-u2f 1.0.7 attempts parsing of the configured authfile (default $HOME/.config/Yubico/u2f_keys) as root (unless openasuser was enabled), and does not properly verify that the path lacks symlinks pointing to other files on the system owned by root. If the debug option is enabled in the PAM configuration, part of the file contents of a symlink target will be logged, possibly revealing sensitive information.\n\nA symbolic link attack has been found in pam-u2f before 1.8.0. The file `$HOME/.config/Yubico/u2f_keys` is blindly followed by the PAM module. It can be a symlink pointing to an arbitrary file. The PAM module only rejects non-regular files and files owned by other users than root or the to-be-authenticated user. Even these checks are only made after open()'ing the file, which may already trigger certain logic in the kernel that is otherwise not reachable to regular users.\r\n\r\nIf the PAM modules' `debug` option is also enabled then most of the content of the file is written either to stdout, stderr, syslog or to the defined debug file. Therefore this can pose an information leak to access e.g.  the contents of /etc/shadow, /root/.bash_history or similar sensitive files. Furthermore the symlink attack can be used to use other\r\nusers' u2f_keys files in the authentication process.",
	"hardware": [],
	"software": [
		{
			"name": "pam-u2f",
			"platform": "archlinux",
			"version": "< 1.0.8-2"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-12",
			"version": "< 1.0.8-1"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-11",
			"version": "< 1.0.8-1"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-10",
			"version": "< 1.0.7-1+deb10u1"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "pam-u2f",
			"platform": "archlinux",
			"version": "< 1.0.8-2"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-12",
			"version": "< 1.0.8-1"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-11",
			"version": "< 1.0.8-1"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-10",
			"version": "< 1.0.7-1+deb10u1"
		},
		{
			"name": "pam-u2f",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "pam-u2f",
			"platform": "archlinux",
			"version": "< 1.0.8-2"
		},
		{
			"name": "pam-u2f",
			"platform": "archlinux",
			"version": "< 1.0.8-2"
		},
		{
			"name": "pam-u2f",
			"platform": "archlinux",
			"version": "< 1.0.8-2"
		},
		{
			"name": "pam-u2f",
			"platform": "archlinux",
			"version": "< 1.0.8-2"
		}
	],
	"references": [
		"https://seclists.org/oss-sec/2019/q2/149",
		"https://bugzilla.suse.com/show_bug.cgi?id=1087061",
		"https://github.com/Yubico/pam-u2f/commit/7db3386fcdb454e33a3ea30dcfb8e8960d4c3aa3",
		"https://developers.yubico.com/pam-u2f/Release_Notes.html",
		"http://www.openwall.com/lists/oss-security/2019/06/05/1",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/5FOR4ADC356JPCHAJI5UXZORLC3VNBPS/",
		"http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00012.html",
		"http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00018.html",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZCGU6UQLI3ZTW3UYCTMQW7VDL5M4LCWR/"
	],
	"severity": "medium",
	"state": "published",
	"_is_edited": false
}