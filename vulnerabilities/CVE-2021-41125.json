{
	"id": "CVE-2021-41125",
	"description": "Scrapy is a high-level web crawling and scraping framework for Python. If you use `HttpAuthMiddleware` (i.e. the `http_user` and `http_pass` spider attributes) for HTTP authentication, all requests will expose your credentials to the request target. This includes requests generated by Scrapy components, such as `robots.txt` requests sent by Scrapy when the `ROBOTSTXT_OBEY` setting is set to `True`, or as requests reached through redirects. Upgrade to Scrapy 2.5.1 and use the new `http_auth_domain` spider attribute to control which domains are allowed to receive the configured HTTP authentication credentials. If you are using Scrapy 1.8 or a lower version, and upgrading to Scrapy 2.5.1 is not an option, you may upgrade to Scrapy 1.8.1 instead. If you cannot upgrade, set your HTTP authentication credentials on a per-request basis, using for example the `w3lib.http.basic_auth_header` function to convert your credentials into a value that you can assign to the `Authorization` header of your request, instead of defining your credentials globally using `HttpAuthMiddleware`.\n\nAffected: scrapy scrapy < 1.8.1, >= 2.0.0, < 2.5.1\n\nA security issue has been found in Scrapy before version 2.5.1. If you use HttpAuthMiddleware (i.e. the http_user and http_pass spider attributes) for HTTP authentication, all requests will expose your credentials to the request target. This includes requests generated by Scrapy components, such as robots.txt requests sent by Scrapy when the ROBOTSTXT_OBEY setting is set to True, or as requests reached through redirects.\r\n\r\nUpgrade to Scrapy 2.5.1 and use the new `http_auth_domain` spider attribute to control which domains are allowed to receive the configured HTTP authentication credentials.",
	"hardware": [],
	"software": [
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-12",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-9",
			"version": "< 1.0.3-2+deb9u1"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-12",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-11",
			"version": "*"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-9",
			"version": "< 1.0.3-2+deb9u1"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-12",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-11",
			"version": "< 2.4.1-2+deb11u1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "scrapy",
			"platform": "archlinux",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-12",
			"version": "< 2.5.1-1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-11",
			"version": "< 2.4.1-2+deb11u1"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "python-scrapy",
			"platform": "debian-10",
			"version": "< 1.5.1-1+deb10u1"
		}
	],
	"references": [
		"https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498",
		"https://github.com/scrapy/scrapy/commit/a1728449712c8df68ad636a7abb9e715a13e1bd0",
		"https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6",
		"https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header",
		"http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth",
		"https://lists.debian.org/debian-lts-announce/2022/03/msg00021.html"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}