{
	"id": "CVE-2020-27171",
	"description": "An issue was discovered in the Linux kernel before 5.11.8. kernel/bpf/verifier.c has an off-by-one error (with a resultant integer underflow) affecting out-of-bounds speculation on pointer arithmetic, leading to side-channel attacks that defeat Spectre mitigations and obtain sensitive information from kernel memory, aka CID-10d2bb2e6b1d.\n\nA numeric error in the Linux kernel mechanism to mitigate speculatively out-of-bounds loads (Spectre mitigation) has been identified. Unprivileged BPF programs running on affected 64-bit systems can exploit this to execute speculatively out-of-bounds loads from 4GB window within the kernel memory. This can be abused to extract contents of kernel memory via side-channel. The identified issue is when computing ptr_limit for preventing out-of-bounds speculation on pointer arithmetic. The computation of ptr_limit is off-by-one whenever the pointer moves to the left. The computed ptr_limit is zero in particular when subtracting zero offset from a pointer that is already at the beginning of map element value. This leads to integer underflow in fixup_bpf_calls() where sanitization code is generated. The issue is fixed in kernel versions 5.11.8 and 5.10.25.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "linux",
			"version": "< 5.11.8.arch1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-hardened",
			"version": "< 5.11.8.hardened1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-zen",
			"version": "< 5.11.8.zen1-1"
		},
		{
			"vendor": "archlinux",
			"product": "linux-lts",
			"version": "< 5.10.25-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "linux",
			"version": "< 5.10.24-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "linux",
			"version": "< 5.10.24-1"
		},
		{
			"vendor": "debian-buster",
			"product": "linux",
			"version": "< 4.19.181-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "linux",
			"version": "< 0"
		},
		{
			"vendor": "debian-stretch",
			"product": "linux-4.19",
			"version": "< 4.19.181-1~deb9u1"
		}
	],
	"references": [
		"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.11.8",
		"https://www.openwall.com/lists/oss-security/2021/03/19/3",
		"https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=10d2bb2e6b1d8c4576c56a748f697dbeb8388899",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QRTPQE73ANG7D6M4L4PK5ZQDPO4Y2FVD/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FB6LUXPEIRLZH32YXWZVEZAD4ZL6SDK2/",
		"http://www.openwall.com/lists/oss-security/2021/03/24/5",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/T2S3I4SLRNRUQDOFYUS6IUAZMQNMPNLG/",
		"https://lists.debian.org/debian-lts-announce/2021/03/msg00035.html",
		"http://packetstormsecurity.com/files/162117/Kernel-Live-Patch-Security-Notice-LSN-0075-1.html",
		"https://www.openwall.com/lists/oss-security/2021/03/24/5",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.11.8&id=c4f3aa4343deccf5b8e1bfcc7c36224aaf3a8b26",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.25&id=ac1b87a18c1ffbe3d093000b762121b5aae0a3f9"
	],
	"_edited_": false,
	"severity": "Medium"
}