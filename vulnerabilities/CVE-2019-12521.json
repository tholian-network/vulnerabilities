{
	"id": "CVE-2019-12521",
	"description": "An issue was discovered in Squid through 4.7. When Squid is parsing ESI, it keeps the ESI elements in ESIContext. ESIContext contains a buffer for holding a stack of ESIElements. When a new ESIElement is parsed, it is added via addStackElement. addStackElement has a check for the number of elements in this buffer, but it's off by 1, leading to a Heap Overflow of 1 element. The overflow is within the same structure so it can't affect adjacent memory blocks, and thus just leads to a crash while processing.\n\nA heap-based out-of-bounds write has been found in Squid before 4.11 or 5.0.2., where a crafted ESI response sent from an upstream server can truncate portions of generated payloads, poisoning the HTTP response cache with corrupted objects. On systems with heap overflow protection overflow will shutdown the proxy causing a denial of service for all clients accessing the Squid service.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "squid",
			"version": "< 4.12-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "squid",
			"version": "< 4.11-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "squid",
			"version": "< 4.11-1"
		},
		{
			"vendor": "debian-buster",
			"product": "squid",
			"version": "< 4.6-1+deb10u2"
		},
		{
			"vendor": "debian-stretch",
			"product": "squid3",
			"version": "< 3.5.23-5+deb9u2"
		}
	],
	"references": [
		"https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12521.txt",
		"http://www.openwall.com/lists/oss-security/2020/04/23/1",
		"https://www.debian.org/security/2020/dsa-4682",
		"http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00018.html",
		"https://security.gentoo.org/glsa/202005-05",
		"https://usn.ubuntu.com/4356-1/",
		"https://lists.debian.org/debian-lts-announce/2020/07/msg00009.html",
		"https://security.netapp.com/advisory/ntap-20210205-0006/",
		"http://www.squid-cache.org/Advisories/SQUID-2019_12.txt",
		"http://www.squid-cache.org/Versions/v4/changesets/squid-4-fdd4123629320aa1ee4c3481bb392437c90d188d.patch"
	],
	"_edited_": false,
	"severity": "High"
}