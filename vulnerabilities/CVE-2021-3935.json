{
	"id": "CVE-2021-3935",
	"description": "When PgBouncer is configured to use \"cert\" authentication, a man-in-the-middle attacker can inject arbitrary SQL queries when a connection is first established, despite the use of TLS certificate verification and encryption. This flaw affects PgBouncer versions prior to 1.16.1.\n\nA security issue has been found in PgBouncer before version 1.16.1. A man-in-the-middle with the ability to inject data into the TCP connection could stuff some cleartext data into the start of a supposedly encryption-protected database session. This could be abused to send faked SQL commands to the server, although that would only work if PgBouncer did not demand any authentication data. (However, a PgBouncer setup relying on SSL certificate authentication might well not do so.)",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "pgbouncer",
			"version": "< 1.16.1-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "pgbouncer",
			"version": "< 1.16.1-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "pgbouncer",
			"version": "< 1.7.2-2+deb9u1"
		}
	],
	"references": [
		"https://bugzilla.redhat.com/show_bug.cgi?id=2021251",
		"http://www.pgbouncer.org/changelog.html#pgbouncer-116x",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TNPCV3KRDI5PLLLKADFVIOHACQJLZMLI/",
		"https://lists.debian.org/debian-lts-announce/2022/02/msg00016.html",
		"https://github.com/pgbouncer/pgbouncer/commit/e4453c9151a2f5af0a9cb049b302a3f9f9654453",
		"https://www.pgbouncer.org/changelog.html#pgbouncer-116x"
	],
	"_edited_": false,
	"severity": "Medium"
}