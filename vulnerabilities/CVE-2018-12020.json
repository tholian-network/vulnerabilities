{
	"id": "CVE-2018-12020",
	"description": "mainproc.c in GnuPG before 2.2.8 mishandles the original filename during decryption and verification actions, which allows remote attackers to spoof the output that GnuPG sends on file descriptor 2 to other programs that use the \"--status-fd 2\" option. For example, the OpenPGP data might represent an original filename that contains line feed characters in conjunction with GOODSIG or VALIDSIG status codes.\n\nA security issue has been found in gnupg before 2.2.8, leading to the possibility of faking verification status of signed content. The OpenPGP protocol allows to include the file name of the original input file into a signed or encrypted message. During decryption and verification the GPG tool can display a notice with that file name. The displayed file name is not sanitized and as such may include line feeds or other control characters. This can be used inject terminal control sequences into the out and, worse, to fake the so-called status messages. These status messages are parsed by programs to get information from gpg about the validity of a signature and an other parameters. Status messages are created with the option \"--status-fd N\" where N is a file descriptor. Now if N is 2 the status messages and the regular diagnostic messages share the stderr output channel. By using a made up file name in the message it is possible to fake status messages. Using this technique it is for example possible to fake the verification status of a signed mail.",
	"hardware": [],
	"software": [
		{
			"vendor": "archlinux",
			"product": "gnupg",
			"version": "< 2.2.8-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "enigmail",
			"version": "< 2:2.0.7-1"
		},
		{
			"vendor": "debian-buster",
			"product": "enigmail",
			"version": "< 2:2.0.7-1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "gnupg1",
			"version": "< 1.4.22-5"
		},
		{
			"vendor": "debian-bullseye",
			"product": "gnupg1",
			"version": "< 1.4.22-5"
		},
		{
			"vendor": "debian-buster",
			"product": "gnupg1",
			"version": "< 1.4.22-5"
		},
		{
			"vendor": "debian-stretch",
			"product": "gnupg1",
			"version": "< 1.4.21-4+deb9u1"
		},
		{
			"vendor": "debian-bookworm",
			"product": "gnupg2",
			"version": "< 2.2.8-1"
		},
		{
			"vendor": "debian-bullseye",
			"product": "gnupg2",
			"version": "< 2.2.8-1"
		},
		{
			"vendor": "debian-buster",
			"product": "gnupg2",
			"version": "< 2.2.8-1"
		},
		{
			"vendor": "debian-stretch",
			"product": "gnupg2",
			"version": "< 2.1.18-8~deb9u2"
		},
		{
			"vendor": "debian-stretch",
			"product": "python-gnupg",
			"version": "< 0.3.9-1+deb9u1"
		}
	],
	"references": [
		"https://usn.ubuntu.com/3675-2/",
		"https://access.redhat.com/errata/RHSA-2018:2180",
		"https://lists.gnupg.org/pipermail/gnupg-announce/2018q2/000425.html",
		"http://openwall.com/lists/oss-security/2018/06/08/2",
		"https://www.debian.org/security/2018/dsa-4222",
		"https://access.redhat.com/errata/RHSA-2018:2181",
		"https://help.ecostruxureit.com/display/public/UADCE725/Security+fixes+in+StruxureWare+Data+Center+Expert+v7.6.0",
		"https://www.debian.org/security/2018/dsa-4224",
		"http://www.securityfocus.com/bid/104450",
		"https://www.debian.org/security/2018/dsa-4223",
		"https://usn.ubuntu.com/3675-3/",
		"http://www.securitytracker.com/id/1041051",
		"https://usn.ubuntu.com/3675-1/",
		"https://dev.gnupg.org/T4012",
		"http://www.openwall.com/lists/oss-security/2019/04/30/4",
		"http://seclists.org/fulldisclosure/2019/Apr/38",
		"http://packetstormsecurity.com/files/152703/Johnny-You-Are-Fired.html",
		"https://usn.ubuntu.com/3964-1/",
		"https://github.com/RUB-NDS/Johnny-You-Are-Fired",
		"https://github.com/RUB-NDS/Johnny-You-Are-Fired/blob/master/paper/johnny-fired.pdf",
		"https://lists.debian.org/debian-lts-announce/2021/12/msg00027.html",
		"https://dev.gnupg.org/rG210e402acd3e284b32db1901e43bf1470e659e49"
	],
	"_edited_": false,
	"severity": "High"
}