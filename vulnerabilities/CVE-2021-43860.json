{
	"id": "CVE-2021-43860",
	"description": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.12.3 and 1.10.6, Flatpak doesn't properly validate that the permissions displayed to the user for an app at install time match the actual permissions granted to the app at runtime, in the case that there's a null byte in the metadata file of an app. Therefore apps can grant themselves permissions without the consent of the user. Flatpak shows permissions to the user during install by reading them from the \"xa.metadata\" key in the commit metadata. This cannot contain a null terminator, because it is an untrusted GVariant. Flatpak compares these permissions to the *actual* metadata, from the \"metadata\" file to ensure it wasn't lied to. However, the actual metadata contents are loaded in several places where they are read as simple C-style strings. That means that, if the metadata file includes a null terminator, only the content of the file from *before* the terminator gets compared to xa.metadata. Thus, any permissions that appear in the metadata file after a null terminator are applied at runtime but not shown to the user. So maliciously crafted apps can give themselves hidden permissions. Users who have Flatpaks installed from untrusted sources are at risk in case the Flatpak has a maliciously crafted metadata file, either initially or in an update. This issue is patched in versions 1.12.3 and 1.10.6. As a workaround, users can manually check the permissions of installed apps by checking the metadata file or the xa.metadata key on the commit metadata.\n\nAffected: flatpak flatpak >= 1.11.0, < 1.12.3, < 1.10.6\n\nAffected: flatpak flatpak >= 1.11.0, < 1.12.3, < 1.10.6",
	"hardware": [],
	"software": [
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-12",
			"version": "< 1.12.3-1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-12",
			"version": "< 1.12.3-1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "*"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-12",
			"version": "< 1.12.3-1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "*"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-1.3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-2.2",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-3.1",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-4",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-5",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-6",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-7",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-8",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-9",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-12",
			"version": "< 1.12.3-1"
		},
		{
			"name": "flatpak",
			"platform": "debian-11",
			"version": "< 1.10.7-0+deb11u1"
		},
		{
			"name": "flatpak",
			"platform": "debian-10",
			"version": "*"
		}
	],
	"references": [
		"https://security-tracker.debian.org/tracker/DSA-5049-1",
		"https://github.com/flatpak/flatpak/security/advisories/GHSA-qpjc-vq3c-572j",
		"https://github.com/flatpak/flatpak/commit/54ec1a482dfc668127eaae57f135e6a8e0bc52da",
		"https://github.com/flatpak/flatpak/commit/65cbfac982cb1c83993a9e19aa424daee8e9f042",
		"https://github.com/flatpak/flatpak/commit/93357d357119093804df05acc32ff335839c6451",
		"https://github.com/flatpak/flatpak/commit/ba818f504c926baaf6e362be8159cfacf994310e",
		"https://github.com/flatpak/flatpak/commit/d9a8f9d8ccc0b7c1135d0ecde006a75d25f66aee",
		"https://github.com/flatpak/flatpak/releases/tag/1.10.6",
		"https://github.com/flatpak/flatpak/releases/tag/1.12.3",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/APFTBYGJJVJPFVHRXUW5PII5XOAFI4KH/",
		"https://www.debian.org/security/2022/dsa-5049",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/APFTBYGJJVJPFVHRXUW5PII5XOAFI4KH/"
	],
	"severity": null,
	"state": "invalid",
	"_is_edited": false
}