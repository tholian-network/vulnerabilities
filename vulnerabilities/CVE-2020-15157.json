{
	"id": "CVE-2020-15157",
	"description": "In containerd (an industry-standard container runtime) before version 1.2.14 there is a credential leaking vulnerability. If a container image manifest in the OCI Image format or Docker Image V2 Schema 2 format includes a URL for the location of a specific image layer (otherwise known as a “foreign layer”), the default containerd resolver will follow that URL to attempt to download it. In v1.2.x but not 1.3.0 or later, the default containerd resolver will provide its authentication credentials if the server where the URL is located presents an HTTP 401 status code along with registry-specific HTTP headers. If an attacker publishes a public image with a manifest that directs one of the layers to be fetched from a web server they control and they trick a user or system into pulling the image, they can obtain the credentials used for pulling that image. In some cases, this may be the user's username and password for the registry. In other cases, this may be the credentials attached to the cloud virtual instance which can grant access to other cloud resources in the account. The default containerd resolver is used by the cri-containerd plugin (which can be used by Kubernetes), the ctr development tool, and other client programs that have explicitly linked against it. This vulnerability has been fixed in containerd 1.2.14. containerd 1.3 and later are not affected. If you are using containerd 1.3 or later, you are not affected. If you are using cri-containerd in the 1.2 series or prior, you should ensure you only pull images from trusted sources. Other container runtimes built on top of containerd but not using the default resolver (such as Docker) are not affected.\n\nAffected: containerd containerd < 1.2.14",
	"hardware": [],
	"software": [
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "containerd",
			"platform": "debian-12",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "containerd",
			"platform": "debian-11",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "docker.io",
			"platform": "debian-12",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-11",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "containerd",
			"platform": "debian-12",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "containerd",
			"platform": "debian-11",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "docker.io",
			"platform": "debian-12",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-11",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "containerd",
			"platform": "debian-12",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "containerd",
			"platform": "debian-11",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "docker.io",
			"platform": "debian-12",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-11",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-1.3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-2.2",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-3.1",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-4",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-5",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-6",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-7",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-8",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "docker.io",
			"platform": "debian-9",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		},
		{
			"name": "containerd",
			"platform": "debian-12",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "containerd",
			"platform": "debian-11",
			"version": "< 1.3.2~ds1-2"
		},
		{
			"name": "docker.io",
			"platform": "debian-12",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-11",
			"version": "< 19.03.13+dfsg2-1"
		},
		{
			"name": "docker.io",
			"platform": "debian-10",
			"version": "< 18.09.1+dfsg1-7.1+deb10u3"
		}
	],
	"references": [
		"https://security-tracker.debian.org/tracker/DSA-4865-1",
		"https://github.com/containerd/containerd/security/advisories/GHSA-742w-89gc-8m9c",
		"https://github.com/containerd/containerd/releases/tag/v1.2.14",
		"https://usn.ubuntu.com/4589-1/",
		"https://usn.ubuntu.com/4589-2/",
		"https://www.debian.org/security/2021/dsa-4865"
	],
	"severity": null,
	"state": "invalid",
	"_is_edited": false
}