{
	"id": "CVE-2021-3653",
	"description": "A flaw was found in the KVM's AMD code for supporting SVM nested virtualization. The flaw occurs when processing the VMCB (virtual machine control block) provided by the L1 guest to spawn/handle a nested guest (L2). Due to improper validation of the \"int_ctl\" field, this issue could allow a malicious L1 to enable AVIC support (Advanced Virtual Interrupt Controller) for the L2 guest. As a result, the L2 guest would be allowed to read/write physical pages of the host, resulting in a crash of the entire system, leak of sensitive data or potential guest-to-host escape. This flaw affects Linux kernel versions prior to 5.14-rc7.\n\nAffected: n/a kernel kernel 5.14-rc7\n\nA security issue has been found in the KVM's AMD code for supporting SVM nested virtualization in the Linux kernel before version 5.13.20. This issue is caused by missing validation of the `int_ctl` VMCB field and allows a malicious L1 guest to enable AVIC support (Advanced Virtual Interrupt Controller) for the L2 guest. The L2 guest is able to write to a limited but still relatively large subset of the host physical memory. Note that AVIC is currently not supported with nesting and it is not advertised in the L1 CPUID.",
	"hardware": [],
	"software": [
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.60-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.12.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.12.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.14.6-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.208-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.290-1"
		},
		{
			"name": "linux-4.19",
			"platform": "debian-9",
			"version": "< 4.19.208-1~deb9u1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.60-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.12.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.12.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-1.3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-2.2",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-3.1",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-4",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-5",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-6",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-7",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-8",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-12",
			"version": "< 5.14.6-1"
		},
		{
			"name": "linux",
			"platform": "debian-11",
			"version": "< 5.10.46-5"
		},
		{
			"name": "linux",
			"platform": "debian-10",
			"version": "< 4.19.208-1"
		},
		{
			"name": "linux",
			"platform": "debian-9",
			"version": "< 4.9.290-1"
		},
		{
			"name": "linux-4.19",
			"platform": "debian-9",
			"version": "< 4.19.208-1~deb9u1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.60-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.12.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.12.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.60-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.12.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.12.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.60-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.12.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.12.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		},
		{
			"name": "linux-lts",
			"platform": "archlinux",
			"version": "< 5.10.60-1"
		},
		{
			"name": "linux-zen",
			"platform": "archlinux",
			"version": "< 5.13.12.zen1-1"
		},
		{
			"name": "linux",
			"platform": "archlinux",
			"version": "< 5.13.12.arch1-1"
		},
		{
			"name": "linux-hardened",
			"platform": "archlinux",
			"version": "< 5.13.13.hardened1-1"
		}
	],
	"references": [
		"https://www.openwall.com/lists/oss-security/2021/08/16/1",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.13.12&id=a0949ee63cf95408870a564ccad163018b1a9e6b",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.60&id=c0883f693187c646c0972d73e525523f9486c2e3",
		"https://security-tracker.debian.org/tracker/DSA-4978-1",
		"https://bugzilla.redhat.com/show_bug.cgi?id=1983686",
		"https://lists.debian.org/debian-lts-announce/2021/10/msg00010.html",
		"https://lists.debian.org/debian-lts-announce/2021/12/msg00012.html",
		"http://packetstormsecurity.com/files/165477/Kernel-Live-Patch-Security-Notice-LSN-0083-1.html"
	],
	"severity": "medium",
	"state": "invalid",
	"_is_edited": false
}