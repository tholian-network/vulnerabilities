{
	"id": "CVE-2021-31535",
	"description": "LookupCol.c in X.Org X through X11R7.7 and libX11 before 1.7.1 might allow remote attackers to execute arbitrary code. The libX11 XLookupColor request (intended for server-side color lookup) contains a flaw allowing a client to send color-name requests with a name longer than the maximum size allowed by the protocol (and also longer than the maximum packet size for normal-sized packets). The user-controlled data exceeding the maximum size is then interpreted by the server as additional X protocol requests and executed, e.g., to disable X server authorization completely. For example, if the victim encounters malicious terminal control sequences for color codes, then the attacker may be able to take full control of the running graphical session.\n\nA security issue has been found in libx11 before version 1.7.1. XLookupColor() and other X libraries function lack proper validation of the length of their string parameters. If those parameters can be controlled by an external application (for instance a color name that can be emitted via a terminal control sequence) it can lead to the emission of extra X protocol requests to the X server.",
	"hardware": [],
	"software": [
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-12",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-11",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.4-3+deb9u4"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-12",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-11",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.4-3+deb9u4"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-12",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-11",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "archlinux",
			"version": "< 1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-1.3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-2.2",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-3.1",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-4",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-5",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-6",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-7",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-8",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-9",
			"version": "< 2:1.6.7-1+deb10u2"
		},
		{
			"name": "libx11",
			"platform": "debian-12",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-11",
			"version": "< 2:1.7.1-1"
		},
		{
			"name": "libx11",
			"platform": "debian-10",
			"version": "< 2:1.6.7-1+deb10u2"
		}
	],
	"references": [
		"https://unparalleled.eu/publications/2021/advisory-unpar-2021-1.txt",
		"https://unparalleled.eu/blog/2021/20210518-using-xterm-to-navigate-the-huge-color-space/",
		"https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/8d2e02ae650f00c4a53deb625211a0527126c605",
		"https://security-tracker.debian.org/tracker/DSA-4920-1",
		"https://lists.freedesktop.org/archives/xorg/",
		"http://www.openwall.com/lists/oss-security/2021/05/18/2",
		"http://seclists.org/fulldisclosure/2021/May/52",
		"http://packetstormsecurity.com/files/162737/libX11-Insufficient-Length-Check-Injection.html",
		"https://lists.debian.org/debian-lts-announce/2021/05/msg00021.html",
		"https://www.debian.org/security/2021/dsa-4920",
		"https://security.gentoo.org/glsa/202105-16",
		"https://www.openwall.com/lists/oss-security/2021/05/18/3",
		"https://www.openwall.com/lists/oss-security/2021/05/18/2",
		"https://lists.x.org/archives/xorg-announce/2021-May/003088.html",
		"https://security.netapp.com/advisory/ntap-20210813-0001/",
		"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TEOT4RLB76RVPJQKGGTIKTBIOLHX2NR6/",
		"https://lists.apache.org/thread.html/r61db8e7dcb56dc000a5387a88f7a473bacec5ee01b9ff3f55308aacc%40%3Cdev.kafka.apache.org%3E",
		"https://lists.apache.org/thread.html/r61db8e7dcb56dc000a5387a88f7a473bacec5ee01b9ff3f55308aacc%40%3Cusers.kafka.apache.org%3E",
		"https://lists.apache.org/thread.html/rbf4ce74b0d1fa9810dec50ba3ace0caeea677af7c27a97111c06ccb7%40%3Cusers.kafka.apache.org%3E",
		"https://lists.apache.org/thread.html/rbf4ce74b0d1fa9810dec50ba3ace0caeea677af7c27a97111c06ccb7%40%3Cdev.kafka.apache.org%3E"
	],
	"severity": "high",
	"state": "published",
	"_is_edited": false
}