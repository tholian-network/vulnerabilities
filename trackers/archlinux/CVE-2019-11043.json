{
	"name": "CVE-2019-11043",
	"type": "arbitrary code execution",
	"severity": "Critical",
	"vector": "Remote",
	"description": "A buffer underflow issue has been found in the php-fpm component of php before 7.3.11, 7.2.24 and 7.1.33, leading to remote code execution in certain nginx + php-fpm configurations. This vulnerability can be exploited if the fastcgi_split_path_info directive contains a regexp that can be broken by an attacker by supplying %0a in the path info which results in the fastcgi_param PATH_INFO being empty.",
	"groups": [
		"AVG-1052"
	],
	"packages": [
		"php"
	],
	"advisories": [
		"ASA-201910-14"
	],
	"references": [
		"https://bugs.php.net/bug.php?id=78599",
		"https://git.php.net/?p=php-src.git;a=commitdiff;h=19e17d3807e6cc0b1ba9443ec5facbd33a61f8fe",
		"https://github.com/neex/phuip-fpizdam"
	],
	"notes": "Workaround:\r\nIf nginx and php-fpm share the same filesystem, one can first check the script actually exists, so the malicious request will never make it to php-fpm (it is usually done using something like `try_files $uri =404`). Or there may be cgi.fix_pathinfo=0 which will also prevent exploitation."
}