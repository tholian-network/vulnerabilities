{
	"name": "CVE-2021-3609",
	"type": "privilege escalation",
	"severity": "Medium",
	"vector": "Local",
	"description": "A race condition in net/can/bcm.c in the Linux kernel before version 5.13.2 allows for local privilege escalation to root. The CAN BCM networking protocol allows to register a CAN message receiver for a specified socket. The function bcm_rx_handler() is run for incoming CAN messages. Simultaneously to running this function, the socket can be closed and bcm_release() will be called. Inside bcm_release(), struct bcm_op and struct bcm_sock are freed while bcm_rx_handler() is still running, finally leading to multiple use-after-free's.",
	"groups": [
		"AVG-2184",
		"AVG-2183",
		"AVG-2182",
		"AVG-2181"
	],
	"packages": [
		"linux",
		"linux-lts",
		"linux-hardened",
		"linux-zen"
	],
	"advisories": [
		"ASA-202107-51",
		"ASA-202107-50",
		"ASA-202107-49",
		"ASA-202107-48"
	],
	"references": [
		"https://www.openwall.com/lists/oss-security/2021/06/19/1",
		"https://www.openwall.com/lists/oss-security/2021/06/19/2",
		"https://github.com/nrb547/kernel-exploitation/blob/main/cve-2021-3609/cve-2021-3609.md",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.13.2&id=014f8baa9d240c4cf7180d37abd625fd4a4527c8",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.12.17&id=d8a5cf5cfc07a296c78bd515671e374b8d8db022",
		"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=v5.10.50&id=b52e0cf0bfc1ede495de36aec86f6013efa18f60"
	],
	"notes": null
}