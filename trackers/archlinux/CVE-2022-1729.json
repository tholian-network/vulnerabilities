{
	"name": "CVE-2022-1729",
	"type": "privilege escalation",
	"severity": "High",
	"vector": "Local",
	"description": "A use-after-free flaw was found in the Linux kernelâ€™s performance events functionality. A user triggers a race condition in setting up performance monitoring between the leading PERF_TYPE_TRACEPOINT and sub PERF_EVENT_HARDWARE plus the PERF_EVENT_SOFTWARE using the perf_event_open() function with these three types. This flaw allows a local user to crash or potentially escalate their privileges on the system.",
	"groups": [
		"AVG-2746",
		"AVG-2744",
		"AVG-2747",
		"AVG-2745"
	],
	"packages": [
		"linux-lts",
		"linux-zen",
		"linux-hardened",
		"linux"
	],
	"advisories": [],
	"references": [
		"https://www.openwall.com/lists/oss-security/2022/05/20/2",
		"https://git.kernel.org/linus/3ac6487e584a1eb54071dbe1212e05b884136704"
	],
	"notes": "By default, except for linux-hardened, an unprivileged user can trigger an attack. For kernel that support to not allow unprivileged users to use performance events, this would require a privileged user with CAP_SYS_ADMIN, CAP_PERFMON or root to be able to abuse this flaw reducing its attack space.\r\nTo confirm the current state, inspect the sysctl with the command:\r\n\r\n    cat /proc/sys/kernel/perf_event_paranoid\r\n\r\nThe setting >=3 would mean that unprivileged users can not use performance events, mitigating the flaw.\r\nA kernel update will be required to mitigate the flaw for root or users with CAP_SYS_ADMIN or CAP_PERFMON capabilities."
}