{
	"identifier": "CVE-2023-29020",
	"description": "@fastify/passport is a port of passport authentication library for the Fastify ecosystem. The CSRF (Cross-Site Request Forger) protection enforced by the '@fastify/csrf-protection' library, when combined with '@fastify/passport' in affected versions, can be bypassed by network and same-site attackers. 'fastify/csrf-protection' implements the synchronizer token pattern (using plugins '@fastify/session' and '@fastify/secure-session') by storing a random value used for CSRF token generation in the '_csrf' attribute of a user's session. The '@fastify/passport' library does not clear the session object upon authentication, preserving the '_csrf' attribute between pre-login and authenticated sessions. Consequently, CSRF tokens generated before authentication are still valid. Network and same-site attackers can thus obtain a CSRF token for their pre-session, fixate that pre-session in the victim's browser via cookie tossing, and then perform a CSRF attack after the victim authenticates. As a solution, newer versions of '@fastify/passport' include the configuration options: 'clearSessionOnLogin (default: true)' and 'clearSessionIgnoreFields (default: ['passport', 'session'])' to clear all the session attributes by default, preserving those explicitly defined in 'clearSessionIgnoreFields'.",
	"type": "none",
	"severity": "none",
	"state": "published",
	"datetime": "2023-04-21T21:15:20Z",
	"is_edited": false,
	"hardware": [],
	"software": [],
	"products": [
		{
			"name": "passport",
			"version": "\u003c 1.1.0",
			"architecture": "any",
			"vendor": "fastify",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "passport",
			"version": "\u003c 2.3.0",
			"architecture": "any",
			"vendor": "fastify",
			"type": "software",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#synchronizer-token-pattern",
		"https://github.com/fastify/fastify-passport/commit/07c90feab9cba0dd4779e47cfb0717a7e2f01d3d",
		"https://github.com/fastify/fastify-passport/security/advisories/GHSA-2ccf-ffrj-m4qw",
		"https://owasp.org/www-community/attacks/csrf"
	],
	"weaknesses": [
		"CWE-352",
		"CWE-384"
	]
}