{
	"identifier": "CVE-2021-21706",
	"description": "A security issue has been found in PHP on Windows before versions 8.0.11 and 7.4.24. It is possible to construct ZIP archives containing files which are placed outside the destination directory given to ZipArchive::extractTo() because the implementation of php_zip_make_relative_path() doesn't properly cater to absolute directories on Windows; a path starting with a slash is not an absolute path on Windows, but rather a relative path pointing to the current volume.",
	"type": "network",
	"severity": "medium",
	"state": "published",
	"datetime": "2021-10-04T02:15:00Z",
	"is_edited": false,
	"hardware": [],
	"software": [
		{
			"name": "php81",
			"version": "\u003c 8.1.0_rc3-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux"
		},
		{
			"name": "php81",
			"version": "\u003c 8.1.0_rc3-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.18"
		},
		{
			"name": "php8",
			"version": "\u003c 8.0.11-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.16"
		},
		{
			"name": "php81",
			"version": "\u003c 8.1.0_rc3-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.16"
		},
		{
			"name": "php7",
			"version": "\u003c 7.4.24-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.13"
		},
		{
			"name": "php8",
			"version": "\u003c 8.0.11-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.13"
		},
		{
			"name": "php7",
			"version": "\u003c 7.3.31-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.12"
		},
		{
			"name": "php81",
			"version": "\u003c 8.1.0_rc3-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "php7",
			"version": "\u003c 7.4.24-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.15"
		},
		{
			"name": "php8",
			"version": "\u003c 8.0.11-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.15"
		},
		{
			"name": "php7",
			"version": "\u003c 7.4.24-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.14"
		},
		{
			"name": "php8",
			"version": "\u003c 8.0.11-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.14"
		},
		{
			"name": "php",
			"version": "\u003c 8.0.11-1",
			"architecture": "any",
			"manager": "pacman",
			"vendor": "archlinux"
		},
		{
			"name": "php7",
			"version": "\u003c 7.4.24-1",
			"architecture": "any",
			"manager": "pacman",
			"vendor": "archlinux"
		},
		{
			"name": "php7.4",
			"version": "\u003c 7.4.33-1+deb11u3",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "php7.3",
			"version": "\u003c 7.3.31-1~deb10u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		}
	],
	"products": [
		{
			"name": "php",
			"version": "\u003c 7.3.31",
			"architecture": "any",
			"vendor": "php",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "php",
			"version": "\u003c 7.4.24",
			"architecture": "any",
			"vendor": "php",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "php",
			"version": "\u003c 8.0.11",
			"architecture": "any",
			"vendor": "php",
			"type": "software",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"https://bugs.php.net/bug.php?id=81420",
		"https://security.netapp.com/advisory/ntap-20211029-0007/",
		"https://www.php.net/ChangeLog-8.php#8.0.11",
		"https://www.php.net/ChangeLog-7.php#7.4.24",
		"https://github.com/php/php-src/commit/9976b5cd7f36d90b49d1dcf58ec6497f0e592b7d#commitcomment-55762818",
		"https://github.com/php/php-src/commit/931bfc29ceb03265a45b4777992e9fc5ad7ee343",
		"https://github.com/php/php-src/commit/648dce9ea95b6d63685fe6efa88e7ef662a4819a",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21706"
	],
	"weaknesses": [
		"CWE-22",
		"CWE-24"
	]
}