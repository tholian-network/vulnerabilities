{
	"identifier": "CVE-2023-31137",
	"description": "MaraDNS is open-source software that implements the Domain Name System (DNS). In version 3.5.0024 and prior, a remotely exploitable integer underflow vulnerability in the DNS packet decompression function allows an attacker to cause a Denial of Service by triggering an abnormal program termination.The vulnerability exists in the 'decomp_get_rddata' function within the 'Decompress.c' file. When handling a DNS packet with an Answer RR of qtype 16 (TXT record) and any qclass, if the 'rdlength' is smaller than 'rdata', the result of the line 'Decompress.c:886' is a negative number 'len = rdlength - total;'. This value is then passed to the 'decomp_append_bytes' function without proper validation, causing the program to attempt to allocate a massive chunk of memory that is impossible to allocate. Consequently, the program exits with an error code of 64, causing a Denial of Service.One proposed fix for this vulnerability is to patch 'Decompress.c:887' by breaking 'if(len \u003c= 0)', which has been incorporated in version 3.5.0036 via commit bab062bde40b2ae8a91eecd522e84d8b993bab58.",
	"type": "none",
	"severity": "medium",
	"state": "published",
	"datetime": "2023-05-09T12:15:00Z",
	"is_edited": false,
	"hardware": [],
	"software": [
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-trusty"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-kinetic"
		},
		{
			"name": "maradns",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-lunar"
		}
	],
	"products": [
		{
			"name": "maradns",
			"version": "\u003c= 3.5.0024",
			"architecture": "any",
			"vendor": "maradns",
			"type": "software",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"https://github.com/samboy/MaraDNS/blob/08b21ea20d80cedcb74aa8f14979ec7c61846663/dns/Decompress.c#L886",
		"https://github.com/samboy/MaraDNS/commit/bab062bde40b2ae8a91eecd522e84d8b993bab58",
		"https://github.com/samboy/MaraDNS/security/advisories/GHSA-58m7-826v-9c3c",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31137"
	],
	"weaknesses": [
		"CWE-191"
	]
}