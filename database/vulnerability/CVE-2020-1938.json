{
	"identifier": "CVE-2020-1938",
	"description": "When using the Apache JServ Protocol (AJP), care must be taken when trusting incoming connections to Apache Tomcat. Tomcat treats AJP connections as having higher trust than, for example, a similar HTTP connection. If such connections are available to an attacker, they can be exploited in ways that may be surprising. In Apache Tomcat 9.0.0.M1 to 9.0.0.30, 8.5.0 to 8.5.50 and 7.0.0 to 7.0.99, Tomcat shipped with an AJP Connector enabled by default that listened on all configured IP addresses. It was expected (and recommended in the security guide) that this Connector would be disabled if not required. This vulnerability report identified a mechanism that allowed: - returning arbitrary files from anywhere in the web application - processing any file in the web application as a JSP Further, if the web application allowed file upload and stored those files within the web application (or the attacker was able to control the content of the web application by some other means) then this, along with the ability to process a file as a JSP, made remote code execution possible. It is important to note that mitigation is only required if an AJP port is accessible to untrusted users. Users wishing to take a defence-in-depth approach and block the vector that permits returning arbitrary files and execution as JSP may upgrade to Apache Tomcat 9.0.31, 8.5.51 or 7.0.100 or later. A number of changes were made to the default AJP Connector configuration in 9.0.31 to harden the default configuration. It is likely that users upgrading to 9.0.31, 8.5.51 or 7.0.100 or later will need to make small changes to their configurations.",
	"type": "network",
	"severity": "critical",
	"state": "published",
	"datetime": "2020-02-24T21:15:00Z",
	"is_edited": false,
	"hardware": [],
	"software": [
		{
			"name": "tomcat9",
			"version": "\u003c 0:9.0.31-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "tomcat9",
			"version": "\u003c 0:9.0.31-1~deb10u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		},
		{
			"name": "tomcat9",
			"version": "\u003c 9.0.31-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "tomcat9",
			"version": "\u003c 9.0.31-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "tomcat9",
			"version": "\u003c 9.0.31-1~deb10u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		},
		{
			"name": "tomcat9",
			"version": "\u003c 9.0.31-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "tomcat8",
			"version": "\u003c 0:8.5.54-0+deb9u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-stretch"
		},
		{
			"name": "tomcat",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-admin-webapps",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-docs-webapp",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-el-2.2-api",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-javadoc",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-jsp-2.2-api",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-jsvc",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-lib",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-servlet-3.0-api",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat-webapps",
			"version": "\u003c 0:7.0.76-11.el7_7",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle7"
		},
		{
			"name": "tomcat6",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-admin-webapps",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-docs-webapp",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-el-2.1-api",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-javadoc",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-jsp-2.1-api",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-lib",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-servlet-2.5-api",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat6-webapps",
			"version": "\u003c 0:6.0.24-114.el6_10",
			"architecture": "any",
			"manager": "any",
			"vendor": "oracle6"
		},
		{
			"name": "tomcat9",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "tomcat9",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-eoan"
		},
		{
			"name": "tomcat8",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "tomcat8",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "tomcat7",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "tomcat7",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "tomcat7",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-trusty"
		}
	],
	"products": [
		{
			"name": "geode",
			"version": "1.12.0",
			"architecture": "any",
			"vendor": "apache",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "tomcat",
			"version": "\u003c= 7.0.99",
			"architecture": "any",
			"vendor": "apache",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "tomcat",
			"version": "\u003c= 8.5.50",
			"architecture": "any",
			"vendor": "apache",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "tomcat",
			"version": "\u003c= 9.0.30",
			"architecture": "any",
			"vendor": "apache",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "fedora",
			"version": "30",
			"architecture": "any",
			"vendor": "fedoraproject",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "fedora",
			"version": "31",
			"architecture": "any",
			"vendor": "fedoraproject",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "fedora",
			"version": "32",
			"architecture": "any",
			"vendor": "fedoraproject",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "agile-engineering-data-management",
			"version": "6.2.1.0",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "agile-plm",
			"version": "9.3.3",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "agile-plm",
			"version": "9.3.5",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "agile-plm",
			"version": "9.3.6",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "communications-element-manager",
			"version": "8.1.1",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "communications-element-manager",
			"version": "8.2.0",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "communications-element-manager",
			"version": "8.2.1",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "communications-instant-messaging-server",
			"version": "10.0.1.4.0",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "health-sciences-empirica-inspections",
			"version": "1.0.1.2",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "health-sciences-empirica-signal",
			"version": "7.3.3",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "hospitality-guest-access",
			"version": "4.2.0",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "hospitality-guest-access",
			"version": "4.2.1",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "instantis-enterprisetrack",
			"version": "\u003c= 17.3",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "mysql-enterprise-monitor",
			"version": "\u003c= 4.0.12",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "mysql-enterprise-monitor",
			"version": "\u003c= 8.0.20",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "siebel-ui-framework",
			"version": "\u003c= 20.5",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "transportation-management",
			"version": "6.3.7",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workload-manager",
			"version": "12.2.0.1",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workload-manager",
			"version": "18c",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workload-manager",
			"version": "19c",
			"architecture": "any",
			"vendor": "oracle",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "debian-linux",
			"version": "8.0",
			"architecture": "any",
			"vendor": "debian",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "debian-linux",
			"version": "9.0",
			"architecture": "any",
			"vendor": "debian",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "debian-linux",
			"version": "10.0",
			"architecture": "any",
			"vendor": "debian",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "leap",
			"version": "15.1",
			"architecture": "any",
			"vendor": "opensuse",
			"type": "system",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "good-control",
			"version": "\u003c= 5.2.58.38",
			"architecture": "any",
			"vendor": "blackberry",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workspaces-server",
			"version": "7.0.1",
			"architecture": "any",
			"vendor": "blackberry",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workspaces-server",
			"version": "7.1.2",
			"architecture": "any",
			"vendor": "blackberry",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workspaces-server",
			"version": "8.1.0",
			"architecture": "any",
			"vendor": "blackberry",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "workspaces-server",
			"version": "9.0",
			"architecture": "any",
			"vendor": "blackberry",
			"type": "software",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00025.html",
		"http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00002.html",
		"http://support.blackberry.com/kb/articleDetail?articleNumber=000062739",
		"https://lists.apache.org/thread.html/r089dc67c0358a1556dd279c762c74f32d7a254a54836b7ee2d839d8e@%3Cdev.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/r1125f3044a0946d1e7e6f125a6170b58d413ebd4a95157e4608041c7@%3Cannounce.apache.org%3E",
		"https://lists.apache.org/thread.html/r17aaa3a05b5b7fe9075613dd0c681efa60a4f8c8fbad152c61371b6e@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r38a5b7943b9a62ecb853acc22ef08ff586a7b3c66e08f949f0396ab1@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r43faacf64570b1d9a4bada407a5af3b2738b0c007b905f1b6b608c65@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r47caef01f663106c2bb81d116b8380d62beac9e543dd3f3bc2c2beda@%3Ccommits.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/r4afa11e0464408e68f0e9560e90b185749363a66398b1491254f7864@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r4f86cb260196e5cfcbbe782822c225ddcc70f54560f14a8f11c6926f@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r549b43509e387a42656f0641fa311bf27c127c244fe02007d5b8d6f6@%3Cdev.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r57f5e4ced436ace518a9e222fabe27fb785f09f5bf974814cc48ca97@%3Ccommits.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/r5e2f1201b92ee05a0527cfc076a81ea0c270be299b87895c0ddbe02b@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r61f280a76902b594692f0b24a1dbf647bb5a4c197b9395e9a6796e7c@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r6a5633cad1b560a1e51f5b425f02918bdf30e090fdf18c5f7c2617eb@%3Ccommits.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/r74328b178f9f37fe759dffbc9c1f2793e66d79d7a8a20d3836551794@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/r75113652e46c4dee687236510649acfb70d2c63e074152049c3f399d@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/r772335e6851ad33ddb076218fa4ff70de1bf398d5b43e2ddf0130e5d@%3Cdev.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r7c6f492fbd39af34a68681dbbba0468490ff1a97a1bd79c6a53610ef%40%3Cannounce.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/r856cdd87eda7af40b50278d6de80ee4b42d63adeb433a34a7bdaf9db@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/r8f7484589454638af527182ae55ef5b628ba00c05c5b11887c922fb1@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/r90890afea72a9571d666820b2fe5942a0a5f86be406fa31da3dd0922@%3Cannounce.apache.org%3E",
		"https://lists.apache.org/thread.html/r92d78655c068d0bc991d1edbdfb24f9c5134603e647cade1113d4e0a@%3Cusers.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/r9f119d9ce9239114022e13dbfe385b3de7c972f24f05d6dbd35c1a2f@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/ra7092f7492569b39b04ec0decf52628ba86c51f15efb38f5853e2760@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/rad36ec6a1ffc9e43266b030c22ceeea569243555d34fb4187ff08522@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/rb1c0fb105ce2b93b7ec6fc1b77dd208022621a91c12d1f580813cfed@%3Cdev.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/rb2fc890bef23cbc7f343900005fe1edd3b091cf18dada455580258f9@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/rbdb1d2b651a3728f0ceba9e0853575b6f90296a94a71836a15f7364a@%3Cdev.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/rc068e824654c4b8bd4f2490bec869e29edbfcd5dfe02d47cbf7433b2@%3Cdev.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/rcd5cd301e9e7e39f939baf2f5d58704750be07a5e2d3393e40ca7194@%3Ccommits.tomee.apache.org%3E",
		"https://lists.apache.org/thread.html/rce2af55f6e144ffcdc025f997eddceb315dfbc0b230e3d750a7f7425@%3Cnotifications.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/rd0774c95699d5aeb5e16e9a600fb2ea296e81175e30a62094e27e3e7@%3Ccommits.ofbiz.apache.org%3E",
		"https://lists.apache.org/thread.html/rd50baccd1bbb96c2327d5a8caa25a49692b3d68d96915bd1cfbb9f8b@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/re5eecbe5bf967439bafeeaa85987b3a43f0e6efe06b6976ee768cde2@%3Cusers.tomcat.apache.org%3E",
		"https://lists.apache.org/thread.html/rf1bbc0ea4a9f014cf94df9a12a6477d24a27f52741dbc87f2fd52ff2@%3Cissues.geode.apache.org%3E",
		"https://lists.apache.org/thread.html/rf26663f42e7f1a1d1cac732469fb5e92c89908a48b61ec546dbb79ca@%3Cbugs.httpd.apache.org%3E",
		"https://lists.apache.org/thread.html/rf992c5adf376294af31378a70aa8a158388a41d7039668821be28df3@%3Ccommits.tomee.apache.org%3E",
		"https://lists.debian.org/debian-lts-announce/2020/03/msg00006.html",
		"https://lists.debian.org/debian-lts-announce/2020/05/msg00026.html",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2XFLQB3O5QVP4ZBIPVIXBEZV7F2R7ZMS/",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/K3IPNHCKFVUKSHDTM45UL4Q765EHHTFG/",
		"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L46WJIV6UV3FWA5O5YEY6XLA73RYD53B/",
		"https://security.gentoo.org/glsa/202003-43",
		"https://security.netapp.com/advisory/ntap-20200226-0002/",
		"https://www.debian.org/security/2020/dsa-4673",
		"https://www.debian.org/security/2020/dsa-4680",
		"https://www.oracle.com/security-alerts/cpujan2021.html",
		"https://www.oracle.com/security-alerts/cpujul2020.html",
		"https://www.oracle.com/security-alerts/cpuoct2020.html",
		"https://linux.oracle.com/errata/ELSA-2020-0855.html",
		"https://linux.oracle.com/errata/ELSA-2020-0912.html",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938",
		"https://www.tenable.com/blog/cve-2020-1938-ghostcat-apache-tomcat-ajp-file-readinclusion-vulnerability-cnvd-2020-10487"
	],
	"weaknesses": []
}