{
	"identifier": "CVE-2020-26896",
	"description": "Prior to 0.11.0-beta, LND (Lightning Network Daemon) had a vulnerability in its invoice database. While claiming on-chain a received HTLC output, it didn't verify that the corresponding outgoing off-chain HTLC was already settled before releasing the preimage. In the case of a hash-and-amount collision with an invoice, the preimage for an expected payment was instead released. A malicious peer could have deliberately intercepted an HTLC intended for the victim node, probed the preimage through a colluding relayed HTLC, and stolen the intercepted HTLC. The impact is a loss of funds in certain situations, and a weakening of the victim's receiver privacy.",
	"type": "network",
	"severity": "medium",
	"state": "published",
	"datetime": "2020-10-21T01:15:12Z",
	"is_edited": false,
	"hardware": [],
	"software": [],
	"products": [
		{
			"name": "lightning-network-daemon",
			"version": "\u003c 0.11.0",
			"architecture": "any",
			"vendor": "lightning-network-daemon-project",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "lightning-network-daemon",
			"version": "0.11.0",
			"architecture": "any",
			"vendor": "lightning-network-daemon-project",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "lightning-network-daemon",
			"version": "0.11.0-beta_rc1",
			"architecture": "any",
			"vendor": "lightning-network-daemon-project",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "lightning-network-daemon",
			"version": "0.11.0-beta_rc2",
			"architecture": "any",
			"vendor": "lightning-network-daemon-project",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "lightning-network-daemon",
			"version": "0.11.0-beta_rc3",
			"architecture": "any",
			"vendor": "lightning-network-daemon-project",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "lightning-network-daemon",
			"version": "0.11.0-beta_rc4",
			"architecture": "any",
			"vendor": "lightning-network-daemon-project",
			"type": "software",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"https://gist.github.com/ariard/6bdeb995565d1cc292753e1ee4ae402d",
		"https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html",
		"https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html"
	],
	"weaknesses": [
		"CWE-354"
	]
}