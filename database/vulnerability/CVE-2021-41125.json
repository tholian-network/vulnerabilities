{
	"identifier": "CVE-2021-41125",
	"description": "A security issue has been found in Scrapy before version 2.5.1. If you use HttpAuthMiddleware (i.e. the http_user and http_pass spider attributes) for HTTP authentication, all requests will expose your credentials to the request target. This includes requests generated by Scrapy components, such as robots.txt requests sent by Scrapy when the ROBOTSTXT_OBEY setting is set to True, or as requests reached through redirects.\r\n\r\nUpgrade to Scrapy 2.5.1 and use the new `http_auth_domain` spider attribute to control which domains are allowed to receive the configured HTTP authentication credentials.",
	"type": "network",
	"severity": "medium",
	"state": "published",
	"datetime": "2021-10-06T17:15:00Z",
	"is_edited": false,
	"hardware": [],
	"software": [
		{
			"name": "scrapy",
			"version": "\u003c 2.5.1-1",
			"architecture": "any",
			"manager": "pacman",
			"vendor": "archlinux"
		},
		{
			"name": "python-scrapy",
			"version": "\u003c 0:2.4.1-2+deb11u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "python-scrapy",
			"version": "\u003c 0:1.5.1-1+deb10u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		},
		{
			"name": "python-scrapy",
			"version": "\u003c 2.5.1-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bookworm"
		},
		{
			"name": "python-scrapy",
			"version": "\u003c 2.4.1-2+deb11u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "python-scrapy",
			"version": "\u003c 1.5.1-1+deb10u1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		},
		{
			"name": "python-scrapy",
			"version": "\u003c 2.5.1-1",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-impish"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-bionic"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-hirsute"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "python-scrapy",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-kinetic"
		}
	],
	"products": [
		{
			"name": "scrapy",
			"version": "\u003c 1.8.1",
			"architecture": "any",
			"vendor": "scrapy",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "scrapy",
			"version": "\u003c 2.5.1",
			"architecture": "any",
			"vendor": "scrapy",
			"type": "software",
			"is_edited": false,
			"aliases": []
		},
		{
			"name": "debian-linux",
			"version": "9.0",
			"architecture": "any",
			"vendor": "debian",
			"type": "system",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth",
		"https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6",
		"https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498",
		"https://lists.debian.org/debian-lts-announce/2022/03/msg00021.html",
		"https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header",
		"https://github.com/scrapy/scrapy/commit/a1728449712c8df68ad636a7abb9e715a13e1bd0",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41125"
	],
	"weaknesses": [
		"CWE-522",
		"CWE-200"
	]
}