{
	"identifier": "CVE-2021-40823",
	"description": "A security has been found in matrix-js-sdk before version 12.4.1, as used by Element Web/Desktop before version 1.8.4. In certain circumstances it may be possible to trick vulnerable clients into disclosing encryption keys for messages previously sent by that client to user accounts later compromised by an attacker.\r\n\r\nExploiting this vulnerability to read encrypted messages requires gaining control over the recipientâ€™s account. This requires either compromising their credentials directly or compromising their homeserver.\r\n\r\nThus, the greatest risk is to users who are in encrypted rooms containing malicious servers. Admins of malicious servers could attempt to impersonate their users' devices in order to spy on messages sent by vulnerable clients in that room.",
	"type": "network",
	"severity": "high",
	"state": "published",
	"datetime": "0000-00-00T00:00:00Z",
	"is_edited": false,
	"hardware": [],
	"software": [
		{
			"name": "riot-web",
			"version": "\u003c 1.8.4-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.16"
		},
		{
			"name": "riot-web",
			"version": "\u003c 1.8.4-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.14"
		},
		{
			"name": "element-web",
			"version": "\u003c 1.8.4-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux"
		},
		{
			"name": "element-web",
			"version": "\u003c 1.8.4-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.18"
		},
		{
			"name": "riot-web",
			"version": "\u003c 1.8.4-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.17"
		},
		{
			"name": "riot-web",
			"version": "\u003c 1.8.4-r0",
			"architecture": "any",
			"manager": "apk",
			"vendor": "alpinelinux-3.15"
		},
		{
			"name": "element-desktop",
			"version": "\u003c 1.8.4-1",
			"architecture": "any",
			"manager": "pacman",
			"vendor": "archlinux"
		},
		{
			"name": "element-web",
			"version": "\u003c 1.8.4-1",
			"architecture": "any",
			"manager": "pacman",
			"vendor": "archlinux"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-bullseye"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-buster"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "debian-sid"
		},
		{
			"name": "cinny",
			"version": "\u003c 1.2.1",
			"architecture": "any",
			"manager": "any",
			"vendor": "freebsd"
		},
		{
			"name": "element-web",
			"version": "\u003c 1.8.3",
			"architecture": "any",
			"manager": "any",
			"vendor": "freebsd"
		},
		{
			"name": "nheko",
			"version": "\u003c= 0.8.2_2",
			"architecture": "any",
			"manager": "any",
			"vendor": "freebsd"
		},
		{
			"name": "element-web",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-impish"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-xenial"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-focal"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-hirsute"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-jammy"
		},
		{
			"name": "node-matrix-js-sdk",
			"version": "any",
			"architecture": "any",
			"manager": "apt",
			"vendor": "ubuntu-kinetic"
		}
	],
	"products": [
		{
			"name": "javascript-sdk",
			"version": "\u003c 12.4.1",
			"architecture": "any",
			"vendor": "matrix",
			"type": "software",
			"is_edited": false,
			"aliases": []
		}
	],
	"references": [
		"https://github.com/matrix-org/matrix-js-sdk/releases/tag/v12.4.1",
		"https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing",
		"https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing/",
		"https://github.com/matrix-org/matrix-js-sdk/commit/894c24880da0e1cc81818f51c0db80e3c9fb2be9",
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40823",
		"https://github.com/matrix-org/matrix-js-sdk/commit/894c24880da0e1cc81818f51c0db80e3c9fb2be9 (v12.4.1)"
	],
	"weaknesses": [
		"CWE-327"
	]
}